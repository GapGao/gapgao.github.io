<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>umiå®æˆ˜ç¬”è®° | ç‰›è½°è½°å¯èƒ½æ˜¯ä¸ªbug</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="ä»‹ç»umi æ˜¯èš‚èšé‡‘æœçš„åº•å±‚å‰ç«¯æ¡†æ¶umiï¼Œä¸­æ–‡å¯å‘éŸ³ä¸ºä¹Œç±³ï¼Œæ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¼ä¸šçº§ react åº”ç”¨æ¡†æ¶ã€‚umi ä»¥è·¯ç”±ä¸ºåŸºç¡€çš„ï¼Œæ”¯æŒç±» next.js çš„çº¦å®šå¼è·¯ç”±ï¼Œä»¥åŠå„ç§è¿›é˜¶çš„è·¯ç”±åŠŸèƒ½ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œæ¯”å¦‚æ”¯æŒè·¯ç”±çº§çš„æŒ‰éœ€åŠ è½½ã€‚ç„¶åé…ä»¥å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œè¦†ç›–ä»æºç åˆ°æ„å»ºäº§ç‰©çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå„ç§åŠŸèƒ½æ‰©å±•å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç›®å‰å†…å¤–éƒ¨åŠ èµ·æ¥å·²æœ‰ 50+ çš„æ’ä»¶ã€‚">
<meta name="keywords" content="react,umi,antd">
<meta property="og:type" content="article">
<meta property="og:title" content="umiå®æˆ˜ç¬”è®°">
<meta property="og:url" content="https://gapgao.github.io/2019/05/09/umiå®æˆ˜ç¬”è®°/index.html">
<meta property="og:site_name" content="ç‰›è½°è½°å¯èƒ½æ˜¯ä¸ªbug">
<meta property="og:description" content="ä»‹ç»umi æ˜¯èš‚èšé‡‘æœçš„åº•å±‚å‰ç«¯æ¡†æ¶umiï¼Œä¸­æ–‡å¯å‘éŸ³ä¸ºä¹Œç±³ï¼Œæ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¼ä¸šçº§ react åº”ç”¨æ¡†æ¶ã€‚umi ä»¥è·¯ç”±ä¸ºåŸºç¡€çš„ï¼Œæ”¯æŒç±» next.js çš„çº¦å®šå¼è·¯ç”±ï¼Œä»¥åŠå„ç§è¿›é˜¶çš„è·¯ç”±åŠŸèƒ½ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œæ¯”å¦‚æ”¯æŒè·¯ç”±çº§çš„æŒ‰éœ€åŠ è½½ã€‚ç„¶åé…ä»¥å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œè¦†ç›–ä»æºç åˆ°æ„å»ºäº§ç‰©çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå„ç§åŠŸèƒ½æ‰©å±•å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç›®å‰å†…å¤–éƒ¨åŠ èµ·æ¥å·²æœ‰ 50+ çš„æ’ä»¶ã€‚">
<meta property="og:locale" content="Chinese">
<meta property="og:image" content="https://gapgao.github.io/img/umi/antd-design-pro-menu.png">
<meta property="og:image" content="https://gapgao.github.io/img/umi/antd-umi.png">
<meta property="og:image" content="https://gapgao.github.io/img/umi/app-menu.png">
<meta property="og:image" content="https://gapgao.github.io/img/umi/app-umi.png">
<meta property="og:updated_time" content="2024-01-04T08:04:02.208Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="umiå®æˆ˜ç¬”è®°">
<meta name="twitter:description" content="ä»‹ç»umi æ˜¯èš‚èšé‡‘æœçš„åº•å±‚å‰ç«¯æ¡†æ¶umiï¼Œä¸­æ–‡å¯å‘éŸ³ä¸ºä¹Œç±³ï¼Œæ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¼ä¸šçº§ react åº”ç”¨æ¡†æ¶ã€‚umi ä»¥è·¯ç”±ä¸ºåŸºç¡€çš„ï¼Œæ”¯æŒç±» next.js çš„çº¦å®šå¼è·¯ç”±ï¼Œä»¥åŠå„ç§è¿›é˜¶çš„è·¯ç”±åŠŸèƒ½ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œæ¯”å¦‚æ”¯æŒè·¯ç”±çº§çš„æŒ‰éœ€åŠ è½½ã€‚ç„¶åé…ä»¥å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œè¦†ç›–ä»æºç åˆ°æ„å»ºäº§ç‰©çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå„ç§åŠŸèƒ½æ‰©å±•å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç›®å‰å†…å¤–éƒ¨åŠ èµ·æ¥å·²æœ‰ 50+ çš„æ’ä»¶ã€‚">
<meta name="twitter:image" content="https://gapgao.github.io/img/umi/antd-design-pro-menu.png">
  
    <link rel="alternative" href="/atom.xml" title="ç‰›è½°è½°å¯èƒ½æ˜¯ä¸ªbug" type="application/atom+xml">
  
  
    <link rel="icon" href="/img/favicon.ico">
  
  
      <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- åŠ è½½ç‰¹æ•ˆ -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet">
  <script>
      var yiliaConfig = {
          rootUrl: '/',
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head></html>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            
            <img lazy-src="/img/head1.jpg" class="js-avatar">
            
        </a>

        <hgroup>
          <h1 class="header-author"><a href="/" title="Hi Mate">GapGao</a></h1>
        </hgroup>

        
        <p class="header-subtitle">ä½†è¡Œå¥½äº‹ è«é—®å‰ç¨‹</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="search" placeholder=" Search...">
            </form>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>èœå•</li>
                        <li>æ ‡ç­¾</li>
                        
                        <li>å‹æƒ…é“¾æ¥</li>
                        
                        
                        <li>å…³äºæˆ‘</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">åšå®¢é¦–é¡µ</a></li>
                        
                            <li><a href="/works">ä½œå“å±•ç¤º</a></li>
                        
                            <li><a href="/about">ç•™è¨€æ‰“å¡</a></li>
                        
                            <li><a href="/FrontEndGuide">å‰ç«¯å¯¼èˆª</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                
                                    <a class="fl mail" target="_self" href="mailto:gaobo_1994@126.com" title="mail">mail</a>

                                
                            
                                
                                    <a class="fl github" target="_blank" href="https://github.com/GapGao" title="github">github</a>
                                
                            
                                
                                    <a class="fl weibo" target="_blank" href="https://weibo.com/u/3812290780" title="weibo">weibo</a>
                                
                            
                                
                                    <a class="fl linkedin" target="_blank" href="https://www.linkedin.com/in/åš-é«˜-544345139" title="linkedin">linkedin</a>
                                
                            
                                
                                    <a class="fl QQ" target="_self" href="/qq" title="QQ">QQ</a>

                                
                            
                                
                                    <a class="fl wechat" target="_self" href="/wechat" title="wechat">wechat</a>

                                
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <a href="/tags/AST/" style="font-size: 10px;">AST</a> <a href="/tags/CJS/" style="font-size: 10px;">CJS</a> <a href="/tags/Cypress/" style="font-size: 10px;">Cypress</a> <a href="/tags/Deno/" style="font-size: 10px;">Deno</a> <a href="/tags/E2Eæµ‹è¯•æµ‹è¯•/" style="font-size: 10px;">E2Eæµ‹è¯•æµ‹è¯•</a> <a href="/tags/ESM/" style="font-size: 10px;">ESM</a> <a href="/tags/Nuxt/" style="font-size: 10px;">Nuxt</a> <a href="/tags/Proxy/" style="font-size: 10px;">Proxy</a> <a href="/tags/UMD/" style="font-size: 10px;">UMD</a> <a href="/tags/WebAssembly/" style="font-size: 10px;">WebAssembly</a> <a href="/tags/antd/" style="font-size: 10px;">antd</a> <a href="/tags/chrome/" style="font-size: 10px;">chrome</a> <a href="/tags/console/" style="font-size: 10px;">console</a> <a href="/tags/device/" style="font-size: 10px;">device</a> <a href="/tags/es6/" style="font-size: 10px;">es6</a> <a href="/tags/express/" style="font-size: 10px;">express</a> <a href="/tags/fiber/" style="font-size: 10px;">fiber</a> <a href="/tags/javascript/" style="font-size: 15px;">javascript</a> <a href="/tags/migration/" style="font-size: 10px;">migration</a> <a href="/tags/parcel/" style="font-size: 10px;">parcel</a> <a href="/tags/react/" style="font-size: 15px;">react</a> <a href="/tags/react15/" style="font-size: 10px;">react15</a> <a href="/tags/react16/" style="font-size: 10px;">react16</a> <a href="/tags/rollup/" style="font-size: 10px;">rollup</a> <a href="/tags/umi/" style="font-size: 10px;">umi</a> <a href="/tags/vconsole/" style="font-size: 10px;">vconsole</a> <a href="/tags/vite/" style="font-size: 10px;">vite</a> <a href="/tags/vue/" style="font-size: 15px;">vue</a> <a href="/tags/vue3/" style="font-size: 10px;">vue3</a> <a href="/tags/webpack/" style="font-size: 10px;">webpack</a> <a href="/tags/wechat/" style="font-size: 15px;">wechat</a> <a href="/tags/å‰ç«¯/" style="font-size: 20px;">å‰ç«¯</a> <a href="/tags/å‰ç«¯å‰æ²¿/" style="font-size: 10px;">å‰ç«¯å‰æ²¿</a> <a href="/tags/å•å…ƒæµ‹è¯•/" style="font-size: 10px;">å•å…ƒæµ‹è¯•</a> <a href="/tags/å°ç¨‹åº/" style="font-size: 10px;">å°ç¨‹åº</a> <a href="/tags/æ‰“åŒ…/" style="font-size: 10px;">æ‰“åŒ…</a> <a href="/tags/çœŸæœºè°ƒè¯•/" style="font-size: 10px;">çœŸæœºè°ƒè¯•</a> <a href="/tags/ç§»åŠ¨ç«¯/" style="font-size: 10px;">ç§»åŠ¨ç«¯</a> <a href="/tags/è‡ªåŠ¨åŒ–æµ‹è¯•/" style="font-size: 15px;">è‡ªåŠ¨åŒ–æµ‹è¯•</a> <a href="/tags/é£å†°/" style="font-size: 10px;">é£å†°</a>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://www.mokahr.com/">mokahr</a>
                    
                      <a target="_blank" class="main-nav-link switch-friends-link" href="http://app.mokahr.com/">mokahr-app</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">çˆ±è¿åŠ¨ã€çˆ±äº¤å‹ã€çˆ±æ—…è¡Œã€å–œæ¬¢æ¥è§¦æ–°é²œäº‹ç‰©ã€è¿æ¥æ–°çš„æŒ‘æˆ˜ï¼Œæ›´çˆ±æ¸¸ç¦»äºé”™ç»¼å¤æ‚çš„ç¼–ç ä¸é€»è¾‘ä¸­</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="Me">GapGao</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="/img/head1.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="Me">GapGao</a></h1>
            </hgroup>
            
            <p class="header-subtitle">ä½†è¡Œå¥½äº‹ è«é—®å‰ç¨‹</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">åšå®¢é¦–é¡µ</a></li>
                
                    <li><a href="/works">ä½œå“å±•ç¤º</a></li>
                
                    <li><a href="/about">ç•™è¨€æ‰“å¡</a></li>
                
                    <li><a href="/FrontEndGuide">å‰ç«¯å¯¼èˆª</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        
                            <a class="mail" target="_self" href="mailto:gaobo_1994@126.com" title="mail">mail</a>
                        
                    
                        
                            <a class="github" target="_blank" href="https://github.com/GapGao" title="github">github</a>
                        
                    
                        
                            <a class="weibo" target="_blank" href="https://weibo.com/u/3812290780" title="weibo">weibo</a>
                        
                    
                        
                            <a class="linkedin" target="_blank" href="https://www.linkedin.com/in/åš-é«˜-544345139" title="linkedin">linkedin</a>
                        
                    
                        
                            <a class="QQ" target="_self" href="/qq" title="QQ">QQ</a>
                        
                    
                        
                            <a class="wechat" target="_self" href="/wechat" title="wechat">wechat</a>
                        
                    
                </div>
            </nav>
        </header>                
    </div>
</nav>
      <div class="body-wrap"><article id="post-umiå®æˆ˜ç¬”è®°" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2019/05/09/umiå®æˆ˜ç¬”è®°/" class="article-date">
      <time datetime="2019-05-09T13:42:45.000Z" itemprop="datePublished">2019-05-09</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      umiå®æˆ˜ç¬”è®°
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/web/">web</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/antd/">antd</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/react/">react</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/umi/">umi</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="ä»‹ç»"><a href="#ä»‹ç»" class="headerlink" title="ä»‹ç»"></a>ä»‹ç»</h1><p>umi æ˜¯èš‚èšé‡‘æœçš„åº•å±‚å‰ç«¯æ¡†æ¶<br>umiï¼Œä¸­æ–‡å¯å‘éŸ³ä¸ºä¹Œç±³ï¼Œæ˜¯ä¸€ä¸ªå¯æ’æ‹”çš„ä¼ä¸šçº§ react åº”ç”¨æ¡†æ¶ã€‚umi ä»¥è·¯ç”±ä¸ºåŸºç¡€çš„ï¼Œæ”¯æŒç±» next.js çš„çº¦å®šå¼è·¯ç”±ï¼Œä»¥åŠå„ç§è¿›é˜¶çš„è·¯ç”±åŠŸèƒ½ï¼Œå¹¶ä»¥æ­¤è¿›è¡ŒåŠŸèƒ½æ‰©å±•ï¼Œæ¯”å¦‚æ”¯æŒè·¯ç”±çº§çš„æŒ‰éœ€åŠ è½½ã€‚ç„¶åé…ä»¥å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œè¦†ç›–ä»æºç åˆ°æ„å»ºäº§ç‰©çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸï¼Œæ”¯æŒå„ç§åŠŸèƒ½æ‰©å±•å’Œä¸šåŠ¡éœ€æ±‚ï¼Œç›®å‰å†…å¤–éƒ¨åŠ èµ·æ¥å·²æœ‰ 50+ çš„æ’ä»¶ã€‚</p>
<a id="more"></a>
<h1 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h1><p>ğŸ“¦ å¼€ç®±å³ç”¨ï¼Œå†…ç½® reactã€react-router ç­‰<br>ğŸˆ ç±» next.js ä¸”åŠŸèƒ½å®Œå¤‡çš„è·¯ç”±çº¦å®šï¼ŒåŒæ—¶æ”¯æŒé…ç½®çš„è·¯ç”±æ–¹å¼<br>ğŸ‰ å®Œå–„çš„æ’ä»¶ä½“ç³»ï¼Œè¦†ç›–ä»æºç åˆ°æ„å»ºäº§ç‰©çš„æ¯ä¸ªç”Ÿå‘½å‘¨æœŸ<br>ğŸš€ é«˜æ€§èƒ½ï¼Œé€šè¿‡æ’ä»¶æ”¯æŒ PWAã€ä»¥è·¯ç”±ä¸ºå•å…ƒçš„ code splitting ç­‰<br>ğŸ’ˆ æ”¯æŒé™æ€é¡µé¢å¯¼å‡ºï¼Œé€‚é…å„ç§ç¯å¢ƒï¼Œæ¯”å¦‚ä¸­å°ä¸šåŠ¡ã€æ— çº¿ä¸šåŠ¡ã€eggã€æ”¯ä»˜å®é’±åŒ…ã€äº‘å‡¤è¶ç­‰<br>ğŸš„ å¼€å‘å¯åŠ¨å¿«ï¼Œæ”¯æŒä¸€é”®å¼€å¯ dll å’Œ hard-source-webpack-plugin ç­‰<br>ğŸ  ä¸€é”®å…¼å®¹åˆ° IE9ï¼ŒåŸºäº umi-plugin-polyfills<br>ğŸ å®Œå–„çš„ TypeScript æ”¯æŒï¼ŒåŒ…æ‹¬ d.ts å®šä¹‰å’Œ umi test<br>ğŸŒ´ ä¸ dva æ•°æ®æµçš„æ·±å…¥èåˆï¼Œæ”¯æŒ duck directoryã€model çš„è‡ªåŠ¨åŠ è½½ã€code splitting ç­‰ç­‰<br>åè¾¹çš„ä¸å¤åˆ¶äº† -&gt; <a href="https://umijs.org/zh/guide" target="_blank" rel="noopener">https://umijs.org/zh/guide</a> umiå®˜æ–¹æ–‡æ¡£</p>
<h1 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h1><blockquote>
<p>1.å®‰è£…node 8.1x<br>2.yarn global add umi æˆ–è€… npm i umi -g æ¨èä½¿ç”¨yarn æœ¬æ–‡åç»­éƒ½ä½¿ç”¨yarnè¿›è¡Œç®¡ç†</p>
</blockquote>
<h1 id="é¡¹ç›®æ­å»º"><a href="#é¡¹ç›®æ­å»º" class="headerlink" title="é¡¹ç›®æ­å»º"></a>é¡¹ç›®æ­å»º</h1><blockquote>
<p>1.mkdir myapp &amp;&amp; cd myapp<br>2.ä½¿ç”¨è„šæ‰‹æ¶æ­å»ºé¡¹ç›®<br>yarn create umi ä½¿ç”¨create-umiè„šæ‰‹æ¶æ¥å¿«é€Ÿåˆ›å»ºé¡¹ç›®ä»£ç </p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">? Select the boilerplate <span class="built_in">type</span> (Use arrow keys)</span><br><span class="line">  ant-design-pro  - åŒ…å« antd-proå¸ƒå±€çš„è„šæ‰‹æ¶</span><br><span class="line">â¯ app             - é€šç”¨é¡¹ç›®è„šæ‰‹æ¶</span><br><span class="line">  block           - Create a umi block.</span><br><span class="line">  library         - åŒºå—è„šæ‰‹æ¶ï¼Œé¡µé¢çº§åˆ«çš„å¯å¤ç”¨çš„ä»£ç ï¼Œå¯ä»¥å®ç°é¡µé¢çš„æŒ‰éœ€åŠ è½½ï¼Œç›®å‰æš‚ä¸æ¸…æ¥šåŒºå—å’Œæ’ ä»¶çš„åŒºåˆ«</span><br><span class="line">  plugin          - umiæ’ä»¶æ¡†æ¶</span><br><span class="line"></span><br><span class="line">  Do you want to use typescript? (y/N) æœ¬åšä¸»æš‚æ—¶ä¸ä¼š åé¢ä¼šå­¦ä¹ ä½¿ç”¨ é€‰N</span><br><span class="line">  (ç„¶åé€‰æ‹©éœ€è¦çš„åŠŸèƒ½,è¿™é‡Œåˆ—å‡ºçš„éƒ½æ˜¯umiçš„é»˜è®¤æ’ä»¶ï¼Œæ ¹æ®éœ€è¦é€‰æ‹©)</span><br><span class="line"></span><br><span class="line">? What functionality <span class="keyword">do</span> you want to <span class="built_in">enable</span>?</span><br><span class="line">  (Press &lt;space&gt; to select, &lt;a&gt; to toggle all, &lt;i&gt; to invert selection)</span><br><span class="line">â¯ â—¯ antd                  - antdç»„ä»¶åº“ é€‰ä¸­</span><br><span class="line">  â—¯ dva                   - dva é¦–å…ˆæ˜¯ä¸€ä¸ªåŸºäº redux å’Œ redux-saga çš„æ•°æ®æµæ–¹æ¡ˆï¼Œ</span><br><span class="line">                            ç„¶åä¸ºäº†ç®€åŒ–å¼€å‘ä½“éªŒï¼Œdva è¿˜é¢å¤–å†…ç½®äº† react-router å’Œ fetchï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç†è§£ä¸ºä¸€ä¸ª</span><br><span class="line">                            è½»é‡çº§çš„åº”ç”¨æ¡†æ¶ã€‚ é€‰ä¸­</span><br><span class="line">  â—¯ code splitting        - webpack å®ç°æŒ‰éœ€åŠ è½½çš„</span><br><span class="line">  â—¯ dll                   - é€šè¿‡ webpack çš„ dll æ’ä»¶é¢„æ‰“åŒ…ä¸€ä»½ dll æ–‡ä»¶æ¥è¾¾åˆ°äºŒæ¬¡å¯åŠ¨æé€Ÿçš„ç›®çš„ã€‚</span><br></pre></td></tr></table></figure>
<blockquote>
<p>4.è¿™é‡Œä¸ºäº†å¿«é€Ÿç†Ÿæ‚‰umiå…ˆç”¨antd(ant-design-pro)å¸ƒå±€çš„æ­å»ºä¸€ä¸ªå°é¡¹ç›®</p>
<blockquote>
<p>1.åˆ›å»ºå¥½ä¹‹å æ‰§è¡Œ yarn å®‰è£…ä¾èµ–<br>æ–‡ä»¶ç›®å½•ï¼š<br><img src="/img/umi/antd-design-pro-menu.png" alt="avatar"><br>2.yarn start å¯åŠ¨é¡¹ç›®<br>æ•ˆæœï¼š<br><img src="/img/umi/antd-umi.png" alt="avatar"><br>â€¦<br>çœ‹å®Œè¿™ä¸ªé¡¹ç›®ä¹‹åï¼Œæˆ‘å‘ç°éƒ½æ˜¯ä¸€äº›æ¯”è¾ƒä¸ªæ€§åŒ–çš„é…ç½®ï¼Œä¸é€‚åˆåˆå­¦è€…ä½¿ç”¨å­¦ä¹ ï¼Œ<br>æ”¾å¼ƒï¼Œå›å½’åˆ°é€‰ç”¨appï¼Œæ­å»ºä¸€ä¸ªé€šç”¨é¡¹ç›®æ¥å­¦ä¹ ï¼Œå¾ˆå°´å°¬</p>
</blockquote>
</blockquote>
<blockquote>
<p>5.æ­å»ºä¸€ä¸ªé€šç”¨é¡¹ç›®</p>
<blockquote>
<p>1.yarn create umi<br>2.é€‰æ‹© app -&gt; use typescript N -&gt; [antd, dva, code splitting]<br>3.yarn å®‰è£…ä¾èµ–<br>ç›®å½•ï¼š<br><img src="/img/umi/app-menu.png" alt="avatar"><br>4.yarn start<br>æ•ˆæœï¼š<br><img src="/img/umi/app-umi.png" alt="avatar"></p>
</blockquote>
</blockquote>
<h1 id="æ–‡ä»¶ç›®å½•ä»‹ç»"><a href="#æ–‡ä»¶ç›®å½•ä»‹ç»" class="headerlink" title="æ–‡ä»¶ç›®å½•ä»‹ç»"></a>æ–‡ä»¶ç›®å½•ä»‹ç»</h1><h2 id="ç›®å½•"><a href="#ç›®å½•" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">â”œâ”€â”€ dist/                          // é»˜è®¤çš„ build è¾“å‡ºç›®å½•</span><br><span class="line">â”œâ”€â”€ mock/                          // mock æ–‡ä»¶æ‰€åœ¨ç›®å½•ï¼ŒåŸºäº express</span><br><span class="line">â”œâ”€â”€ config/</span><br><span class="line">    â”œâ”€â”€ config.js                  // umi é…ç½®ï¼ŒåŒ .umirc.jsï¼ŒäºŒé€‰ä¸€</span><br><span class="line">â””â”€â”€ src/                           // æºç ç›®å½•ï¼Œå¯é€‰</span><br><span class="line">    â”œâ”€â”€ layouts/index.js           // å…¨å±€å¸ƒå±€</span><br><span class="line">    â”œâ”€â”€ pages/                     // é¡µé¢ç›®å½•ï¼Œé‡Œé¢çš„æ–‡ä»¶å³è·¯ç”±</span><br><span class="line">        â”œâ”€â”€ .umi/                  // dev ä¸´æ—¶ç›®å½•ï¼Œéœ€æ·»åŠ åˆ° .gitignore</span><br><span class="line">        â”œâ”€â”€ .umi-production/       // build ä¸´æ—¶ç›®å½•ï¼Œä¼šè‡ªåŠ¨åˆ é™¤</span><br><span class="line">        â”œâ”€â”€ document.ejs           // HTML æ¨¡æ¿</span><br><span class="line">        â”œâ”€â”€ 404.js                 // 404 é¡µé¢</span><br><span class="line">        â”œâ”€â”€ page1.js               // é¡µé¢ 1ï¼Œä»»æ„å‘½åï¼Œå¯¼å‡º react ç»„ä»¶</span><br><span class="line">        â”œâ”€â”€ page1.test.js          // ç”¨ä¾‹æ–‡ä»¶ï¼Œumi <span class="built_in">test</span> ä¼šåŒ¹é…æ‰€æœ‰ .test.js å’Œ .e2e.js ç»“å°¾çš„æ–‡ä»¶</span><br><span class="line">        â””â”€â”€ page2.js               // é¡µé¢ 2ï¼Œä»»æ„å‘½å</span><br><span class="line">    â”œâ”€â”€ global.css                 // çº¦å®šçš„å…¨å±€æ ·å¼æ–‡ä»¶ï¼Œè‡ªåŠ¨å¼•å…¥ï¼Œä¹Ÿå¯ä»¥ç”¨ global.less</span><br><span class="line">    â”œâ”€â”€ global.js                  // å¯ä»¥åœ¨è¿™é‡ŒåŠ å…¥ polyfill</span><br><span class="line">    â”œâ”€â”€ app.js                     // è¿è¡Œæ—¶é…ç½®æ–‡ä»¶</span><br><span class="line">â”œâ”€â”€ .umirc.js                      // umi é…ç½®ï¼ŒåŒ config/config.jsï¼ŒäºŒé€‰ä¸€</span><br><span class="line">â”œâ”€â”€ .env                           // ç¯å¢ƒå˜é‡</span><br><span class="line">â””â”€â”€ package.json</span><br></pre></td></tr></table></figure>
<h2 id="ES6-è¯­æ³•"><a href="#ES6-è¯­æ³•" class="headerlink" title="ES6 è¯­æ³•"></a>ES6 è¯­æ³•</h2><p>é…ç½®æ–‡ä»¶ã€mock æ–‡ä»¶ç­‰éƒ½æœ‰é€šè¿‡ @babel/register æ³¨å†Œå®æ—¶ç¼–è¯‘ï¼Œæ‰€ä»¥å¯ä»¥å’Œ src é‡Œçš„æ–‡ä»¶ä¸€æ ·ï¼Œä½¿ç”¨ ES6 çš„è¯­æ³•å’Œ es modules ã€‚</p>
<h2 id="dist"><a href="#dist" class="headerlink" title="dist"></a>dist</h2><p>é»˜è®¤è¾“å‡ºè·¯å¾„ï¼Œå¯é€šè¿‡é…ç½® outputPath ä¿®æ”¹ã€‚</p>
<h2 id="mock"><a href="#mock" class="headerlink" title="mock"></a>mock</h2><p>æ­¤ç›®å½•ä¸‹æ‰€æœ‰çš„ .js æ–‡ä»¶ï¼ˆåŒ…æ‹¬ _ å‰ç¼€çš„ï¼‰éƒ½ä¼šè¢«è§£æä¸º mock æ–‡ä»¶ã€‚<br>æ¯”å¦‚ï¼Œæ–°å»º mock/users.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="string">'/api/users'</span>: [<span class="string">'a'</span>, <span class="string">'b'</span>],</span><br><span class="line">&#125;</span><br><span class="line">ç„¶ååœ¨æµè§ˆå™¨é‡Œè®¿é—® <span class="string">'http://localhost:8000/api/users'</span> å°±å¯ä»¥çœ‹åˆ° [<span class="string">'a'</span>, <span class="string">'b'</span>] äº†ã€‚</span><br></pre></td></tr></table></figure>
<h2 id="src"><a href="#src" class="headerlink" title="src"></a>src</h2><p>çº¦å®š src ä¸ºæºç ç›®å½•ï¼Œå¦‚æœä¸å­˜åœ¨ src ç›®å½•ï¼Œåˆ™å½“å‰ç›®å½•ä¼šè¢«ä½œä¸ºæºç ç›®å½•ã€‚<br>æ¯”å¦‚ï¼šä¸‹é¢ä¸¤ç§ç›®å½•ç»“æ„çš„æ•ˆæœæ˜¯ä¸€è‡´çš„ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">+ src</span><br><span class="line">  + pages</span><br><span class="line">    - index.js</span><br><span class="line">  + layouts</span><br><span class="line">    - index.js</span><br><span class="line">- .umirc.js</span><br><span class="line">+ pages</span><br><span class="line">  - index.js</span><br><span class="line">+ layouts</span><br><span class="line">  - index.js</span><br><span class="line">- .umirc.js</span><br></pre></td></tr></table></figure>
<h2 id="src-layouts-index-js"><a href="#src-layouts-index-js" class="headerlink" title="src/layouts/index.js"></a>src/layouts/index.js</h2><blockquote>
<p>æ³¨ï¼šé…ç½®å¼è·¯ç”±ä¸‹æ— æ•ˆã€‚</p>
</blockquote>
<p>å…¨å±€å¸ƒå±€ï¼Œåœ¨è·¯ç”±å¤–é¢å¥—çš„ä¸€å±‚è·¯ç”±ã€‚<br>æ¯”å¦‚ï¼Œä½ çš„è·¯ç”±æ˜¯ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './pages/index' &#125;,</span><br><span class="line">  &#123; path: '/users', component: './pages/users' &#125;,</span><br><span class="line">]</span><br><span class="line">å¦‚æœæœ‰ layouts/index.jsï¼Œé‚£ä¹ˆè·¯ç”±å°±ä¼šå˜ä¸ºï¼š</span><br><span class="line"></span><br><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './layouts/index', routes: [</span><br><span class="line">    &#123; path: '/', component: './pages/index' &#125;,</span><br><span class="line">    &#123; path: '/users', component: './pages/users' &#125;,</span><br><span class="line">  ] &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="src-pages"><a href="#src-pages" class="headerlink" title="src/pages"></a>src/pages</h2><p>çº¦å®š pages ä¸‹æ‰€æœ‰çš„ jsã€jsxã€ts å’Œ tsx æ–‡ä»¶å³è·¯ç”±ã€‚</p>
<blockquote>
<p>æ³¨ï¼šé…ç½®å¼è·¯ç”±ä¸‹æ— æ•ˆã€‚</p>
</blockquote>
<h2 id="src-pages-404-js"><a href="#src-pages-404-js" class="headerlink" title="src/pages/404.js"></a>src/pages/404.js</h2><p>404 é¡µé¢ã€‚æ³¨æ„å¼€å‘æ¨¡å¼ä¸‹æœ‰å†…ç½® umi æä¾›çš„ 404 æç¤ºé¡µé¢ï¼Œæ‰€ä»¥åªæœ‰æ˜¾å¼è®¿é—® /404 æ‰èƒ½è®¿é—®åˆ°è¿™ä¸ªé¡µé¢ã€‚</p>
<h2 id="src-pages-document-ejs"><a href="#src-pages-document-ejs" class="headerlink" title="src/pages/document.ejs"></a>src/pages/document.ejs</h2><p>æœ‰è¿™ä¸ªæ–‡ä»¶æ—¶ï¼Œä¼šè¦†ç›–é»˜è®¤çš„ HTML æ¨¡æ¿ã€‚<br>æ¨¡æ¿é‡Œéœ€è‡³å°‘åŒ…å«æ ¹èŠ‚ç‚¹çš„ HTML ä¿¡æ¯</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="src-pages-umi"><a href="#src-pages-umi" class="headerlink" title="src/pages/.umi"></a>src/pages/.umi</h2><p>è¿™æ˜¯ umi dev æ—¶ç”Ÿäº§çš„ä¸´æ—¶ç›®å½•ï¼Œé»˜è®¤åŒ…å« umi.js å’Œ router.jsï¼Œæœ‰äº›æ’ä»¶(dva, babel)ä¹Ÿä¼šåœ¨è¿™é‡Œç”Ÿæˆä¸€äº›å…¶ä»–ä¸´æ—¶æ–‡ä»¶ã€‚å¯ä»¥åœ¨è¿™é‡Œåšä¸€äº›éªŒè¯ï¼Œä½†è¯·ä¸è¦ç›´æ¥åœ¨è¿™é‡Œä¿®æ”¹ä»£ç ï¼Œumi é‡å¯æˆ–è€… pages ä¸‹çš„æ–‡ä»¶ä¿®æ”¹éƒ½ä¼šé‡æ–°ç”Ÿæˆè¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶ã€‚</p>
<h2 id="src-pages-umi-production"><a href="#src-pages-umi-production" class="headerlink" title="src/pages/.umi-production"></a>src/pages/.umi-production</h2><p>åŒ src/pages/.umiï¼Œä½†æ˜¯æ˜¯åœ¨ umi build æ—¶ç”Ÿæˆçš„ï¼Œumi build æ‰§è¡Œå®Œè‡ªåŠ¨åˆ é™¤ã€‚</p>
<h2 id="test-js-ts-å’Œ-e2e-js-ts"><a href="#test-js-ts-å’Œ-e2e-js-ts" class="headerlink" title=".test.(js|ts) å’Œ .e2e.(js|ts)"></a>.test.(js|ts) å’Œ .e2e.(js|ts)</h2><p>æµ‹è¯•æ–‡ä»¶ï¼Œumi test ä¼šæŸ¥æ‰¾æ‰€æœ‰çš„ .test.js å’Œ .e2e.js æ–‡ä»¶æ¥è·‘æµ‹è¯•ã€‚</p>
<h2 id="src-global-js-ts"><a href="#src-global-js-ts" class="headerlink" title="src/global.(js|ts)"></a>src/global.(js|ts)</h2><p>æ­¤æ–‡ä»¶ä¼šåœ¨å…¥å£æ–‡ä»¶çš„æœ€å‰é¢è¢«è‡ªåŠ¨å¼•å…¥ï¼Œå¯ä»¥åœ¨è¿™é‡ŒåŠ è½½è¡¥ä¸ï¼Œåšä¸€äº›åˆå§‹åŒ–çš„æ“ä½œç­‰ã€‚</p>
<h2 id="src-global-css-less-sass-scss"><a href="#src-global-css-less-sass-scss" class="headerlink" title="src/global.(css|less|sass|scss)"></a>src/global.(css|less|sass|scss)</h2><p>æ­¤æ–‡ä»¶ä¸èµ° css modulesï¼Œä¸”ä¼šè‡ªåŠ¨è¢«å¼•å…¥ï¼Œå¯ä»¥åœ¨è¿™é‡Œå†™å…¨å±€æ ·å¼ï¼Œä»¥åŠåšæ ·å¼è¦†ç›–ã€‚</p>
<h2 id="src-app-js-ts"><a href="#src-app-js-ts" class="headerlink" title="src/app.(js|ts)"></a>src/app.(js|ts)</h2><p>è¿è¡Œæ—¶é…ç½®æ–‡ä»¶ï¼Œå¯ä»¥åœ¨è¿™é‡Œæ‰©å±•è¿è¡Œæ—¶çš„èƒ½åŠ›ï¼Œæ¯”å¦‚ä¿®æ”¹è·¯ç”±ã€ä¿®æ”¹ render æ–¹æ³•ç­‰ã€‚</p>
<h2 id="umirc-js-ts-å’Œ-config-config-js-ts"><a href="#umirc-js-ts-å’Œ-config-config-js-ts" class="headerlink" title=".umirc.(js|ts) å’Œ config/config.(js|ts)"></a>.umirc.(js|ts) å’Œ config/config.(js|ts)</h2><p>ç¼–è¯‘æ—¶é…ç½®æ–‡ä»¶ï¼ŒäºŒé€‰ä¸€ï¼Œä¸å¯å…±å­˜ã€‚</p>
<h2 id="env"><a href="#env" class="headerlink" title=".env"></a>.env</h2><p>ç¯å¢ƒå˜é‡é…ç½®æ–‡ä»¶ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CLEAR_CONSOLE=none</span><br><span class="line">BROWSER=none</span><br></pre></td></tr></table></figure>
<h1 id="è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰"><a href="#è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰" class="headerlink" title="è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰"></a>è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰</h1><blockquote>
<p>è·¯ç”±ä½¿ç”¨å¯ä»¥åœ¨ umi-examples/routes å’Œ umi-examples/routes-via-config é‡Œæ‰¾åˆ°ç¤ºä¾‹ä»£ç ã€‚<br>umi ä¼šæ ¹æ® pages ç›®å½•è‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®ã€‚</p>
</blockquote>
<h2 id="çº¦å®šå¼è·¯ç”±"><a href="#çº¦å®šå¼è·¯ç”±" class="headerlink" title="çº¦å®šå¼è·¯ç”±"></a>çº¦å®šå¼è·¯ç”±</h2><h3 id="åŸºç¡€è·¯ç”±"><a href="#åŸºç¡€è·¯ç”±" class="headerlink" title="åŸºç¡€è·¯ç”±"></a>åŸºç¡€è·¯ç”±</h3><p>å‡è®¾ pages ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  + users/</span><br><span class="line">    - index.js</span><br><span class="line">    - list.js</span><br><span class="line">  - index.js</span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆï¼Œumi ä¼šè‡ªåŠ¨ç”Ÿæˆè·¯ç”±é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './pages/index.js' &#125;,</span><br><span class="line">  &#123; path: '/users/', component: './pages/users/index.js' &#125;,</span><br><span class="line">  &#123; path: '/users/list', component: './pages/users/list.js' &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="åŠ¨æ€è·¯ç”±"><a href="#åŠ¨æ€è·¯ç”±" class="headerlink" title="åŠ¨æ€è·¯ç”±"></a>åŠ¨æ€è·¯ç”±</h3><p>umi é‡Œçº¦å®šï¼Œå¸¦ $ å‰ç¼€çš„ç›®å½•æˆ–æ–‡ä»¶ä¸ºåŠ¨æ€è·¯ç”±ã€‚</p>
<p>æ¯”å¦‚ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  + <span class="variable">$post</span>/</span><br><span class="line">    - index.js</span><br><span class="line">    - comments.js</span><br><span class="line">  + users/</span><br><span class="line">    <span class="variable">$id</span>.js</span><br><span class="line">  - index.js</span><br></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆè·¯ç”±é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './pages/index.js' &#125;,</span><br><span class="line">  &#123; path: '/users/:id', component: './pages/users/$id.js' &#125;,</span><br><span class="line">  &#123; path: '/:post/', component: './pages/$post/index.js' &#125;,</span><br><span class="line">  &#123; path: '/:post/comments', component: './pages/$post/comments.js' &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="å¯é€‰çš„åŠ¨æ€è·¯ç”±"><a href="#å¯é€‰çš„åŠ¨æ€è·¯ç”±" class="headerlink" title="å¯é€‰çš„åŠ¨æ€è·¯ç”±"></a>å¯é€‰çš„åŠ¨æ€è·¯ç”±</h3><p>umi é‡Œçº¦å®šåŠ¨æ€è·¯ç”±å¦‚æœå¸¦ $ åç¼€ï¼Œåˆ™ä¸ºå¯é€‰åŠ¨æ€è·¯ç”±ã€‚</p>
<p>æ¯”å¦‚ä»¥ä¸‹ç»“æ„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  + users/</span><br><span class="line">    - <span class="variable">$id</span>$.js</span><br><span class="line">  - index.js</span><br></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆè·¯ç”±é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/': component: './pages/index.js' &#125;,</span><br><span class="line">  &#123; path: '/users/:id?': component: './pages/users/$id$.js' &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h3><p>umi é‡Œçº¦å®šç›®å½•ä¸‹æœ‰ _layout.js æ—¶ä¼šç”ŸæˆåµŒå¥—è·¯ç”±ï¼Œä»¥ _layout.js ä¸ºè¯¥ç›®å½•çš„ layout ã€‚</p>
<p>æ¯”å¦‚ä»¥ä¸‹ç›®å½•ç»“æ„ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  + users/</span><br><span class="line">    - _layout.js</span><br><span class="line">    - <span class="variable">$id</span>.js</span><br><span class="line">    - index.js</span><br></pre></td></tr></table></figure>
<p>ä¼šç”Ÿæˆè·¯ç”±é…ç½®å¦‚ä¸‹ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/users', component: './pages/users/_layout.js',</span><br><span class="line">    routes: [</span><br><span class="line">     &#123; path: '/users/', component: './pages/users/index.js' &#125;,</span><br><span class="line">     &#123; path: '/users/:id', component: './pages/users/$id.js' &#125;,</span><br><span class="line">   ],</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="å…¨å±€-layout"><a href="#å…¨å±€-layout" class="headerlink" title="å…¨å±€ layout"></a>å…¨å±€ layout</h3><p>çº¦å®š src/layouts/index.js ä¸ºå…¨å±€è·¯ç”±ï¼Œè¿”å›ä¸€ä¸ª React ç»„ä»¶ï¼Œé€šè¿‡ props.children æ¸²æŸ“å­ç»„ä»¶ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;Header /&gt;</span><br><span class="line">      &#123; props.children &#125;</span><br><span class="line">      &lt;Footer /&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="ä¸åŒçš„å…¨å±€-layout"><a href="#ä¸åŒçš„å…¨å±€-layout" class="headerlink" title="ä¸åŒçš„å…¨å±€ layout"></a>ä¸åŒçš„å…¨å±€ layout</h3><p>ä½ å¯èƒ½éœ€è¦é’ˆå¯¹ä¸åŒè·¯ç”±è¾“å‡ºä¸åŒçš„å…¨å±€ layoutï¼Œumi ä¸æ”¯æŒè¿™æ ·çš„é…ç½®ï¼Œä½†ä½ ä»å¯ä»¥åœ¨ layouts/index.js å¯¹ location.path åšåŒºåˆ†ï¼Œæ¸²æŸ“ä¸åŒçš„ layout ã€‚</p>
<p>æ¯”å¦‚æƒ³è¦é’ˆå¯¹ /login è¾“å‡ºç®€å•å¸ƒå±€ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span>(<span class="params">props</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (props.location.pathname === <span class="string">'/login'</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">SimpleLayout</span>&gt;</span>&#123; props.children &#125;<span class="tag">&lt;/<span class="name">SimpleLayout</span>&gt;</span></span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;&gt;</span><br><span class="line">      &lt;Header /&gt;</span><br><span class="line">      &#123; props.children &#125;</span><br><span class="line">      &lt;Footer /&gt;</span><br><span class="line">    &lt;<span class="regexp">/&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="404-è·¯ç”±"><a href="#404-è·¯ç”±" class="headerlink" title="404 è·¯ç”±"></a>404 è·¯ç”±</h3><p>çº¦å®š pages/404.js ä¸º 404 é¡µé¢ï¼Œéœ€è¿”å› React ç»„ä»¶ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;I am a customized <span class="number">404</span> page&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">  );</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼šå¼€å‘æ¨¡å¼ä¸‹ï¼Œumi ä¼šæ·»åŠ ä¸€ä¸ªé»˜è®¤çš„ 404 é¡µé¢æ¥è¾…åŠ©å¼€å‘ï¼Œä½†ä½ ä»ç„¶å¯é€šè¿‡ç²¾ç¡®åœ°è®¿é—® /404 æ¥éªŒè¯ 404 é¡µé¢ã€‚</p>
</blockquote>
<h3 id="é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±"><a href="#é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±" class="headerlink" title="é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±"></a>é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±</h3><p>çº¦å®šè·¯ç”±æ–‡ä»¶çš„é¦–ä¸ªæ³¨é‡Šå¦‚æœåŒ…å« yaml æ ¼å¼çš„é…ç½®ï¼Œåˆ™ä¼šè¢«ç”¨äºæ‰©å±•è·¯ç”±ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">+ pages/</span><br><span class="line">  - index.js</span><br><span class="line">å¦‚æœ pages/index.js é‡ŒåŒ…å«ï¼š</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * title: Index Page</span><br><span class="line"> * Routes:</span><br><span class="line"> *   - ./src/routes/a.js</span><br><span class="line"> *   - ./src/routes/b.js</span><br><span class="line"> */</span><br></pre></td></tr></table></figure>
<p>åˆ™ä¼šç”Ÿæˆè·¯ç”±é…ç½®ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './index.js',</span><br><span class="line">    title: 'Index Page',</span><br><span class="line">    Routes: [ './src/routes/a.js', './src/routes/b.js' ],</span><br><span class="line">  &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®å¼è·¯ç”±"><a href="#é…ç½®å¼è·¯ç”±" class="headerlink" title="é…ç½®å¼è·¯ç”±"></a>é…ç½®å¼è·¯ç”±</h2><p>å¦‚æœä½ å€¾å‘äºä½¿ç”¨é…ç½®å¼çš„è·¯ç”±ï¼Œå¯ä»¥é…ç½® routes ï¼Œæ­¤é…ç½®é¡¹å­˜åœ¨æ—¶åˆ™ä¸ä¼šå¯¹ src/pages ç›®å½•åšçº¦å®šå¼çš„è§£æã€‚ï¼ˆå’±ä»¬å…ˆæŒ‰çº¦å®šå¼è·¯ç”±æä¸€éï¼Œç„¶ååè¾¹å†æ¥ä¸€å¥—é…ç½®å¼è·¯ç”±çš„ï¼‰</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  routes: [</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">component</span>: <span class="string">'./a'</span> &#125;,</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">'/list'</span>, <span class="attr">component</span>: <span class="string">'./b'</span>, <span class="attr">Routes</span>: [<span class="string">'./routes/PrivateRoute.js'</span>] &#125;,</span><br><span class="line">    &#123; <span class="attr">path</span>: <span class="string">'/users'</span>, <span class="attr">component</span>: <span class="string">'./users/_layout'</span>,</span><br><span class="line">      routes: [</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/users/detail'</span>, <span class="attr">component</span>: <span class="string">'./users/detail'</span> &#125;,</span><br><span class="line">        &#123; <span class="attr">path</span>: <span class="string">'/users/:id'</span>, <span class="attr">component</span>: <span class="string">'./users/id'</span> &#125;</span><br><span class="line">      ]</span><br><span class="line">    &#125;,</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨æ„ï¼š<br>component æ˜¯ç›¸å¯¹äº src/pages ç›®å½•çš„</p>
</blockquote>
<h2 id="æƒé™è·¯ç”±"><a href="#æƒé™è·¯ç”±" class="headerlink" title="æƒé™è·¯ç”±"></a>æƒé™è·¯ç”±</h2><p>umi çš„æƒé™è·¯ç”±æ˜¯é€šè¿‡é…ç½®è·¯ç”±çš„ Routes å±æ€§æ¥å®ç°ã€‚çº¦å®šå¼çš„é€šè¿‡ yaml æ³¨é‡Šæ·»åŠ ï¼Œé…ç½®å¼çš„ç›´æ¥é…ä¸Šå³å¯ã€‚</p>
<p>æ¯”å¦‚æœ‰ä»¥ä¸‹é…ç½®ï¼š</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  &#123; path: '/', component: './pages/index.js' &#125;,</span><br><span class="line">  &#123; path: '/list', component: './pages/list.js', Routes: ['./routes/PrivateRoute.js'] &#125;,</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<p>ç„¶å umi ä¼šç”¨ ./routes/PrivateRoute.js æ¥æ¸²æŸ“ /listã€‚</p>
<p>./routes/PrivateRoute.js æ–‡ä»¶ç¤ºä¾‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> (props) =&gt; &#123;</span><br><span class="line">  <span class="keyword">return</span> (</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">      &lt;div&gt;PrivateRoute (routes/PrivateRoute.js)&lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">      &#123; props.children &#125;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>div&gt;</span><br><span class="line">  );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="è·¯ç”±åŠ¨æ•ˆ"><a href="#è·¯ç”±åŠ¨æ•ˆ" class="headerlink" title="è·¯ç”±åŠ¨æ•ˆ"></a>è·¯ç”±åŠ¨æ•ˆ</h2><p>è·¯ç”±åŠ¨æ•ˆåº”è¯¥æ˜¯æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œè¿™é‡Œä¸¾ react-transition-group çš„ä¾‹å­ã€‚</p>
<p>å…ˆå®‰è£…ä¾èµ–ï¼Œ</p>
<p>$ yarn add react-transition-group<br>åœ¨ layout ç»„ä»¶ï¼ˆlayouts/index.js æˆ–è€… pages å­ç›®å½•ä¸‹çš„ _layout.jsï¼‰é‡Œåœ¨æ¸²æŸ“å­ç»„ä»¶æ—¶ç”¨ TransitionGroup å’Œ CSSTransition åŒ…è£¹ä¸€å±‚ï¼Œå¹¶ä»¥ location.pathname ä¸º keyï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> withRouter <span class="keyword">from</span> <span class="string">'umi/withRouter'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; TransitionGroup, CSSTransition &#125; <span class="keyword">from</span> <span class="string">"react-transition-group"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(</span><br><span class="line">  (&#123; location &#125;) =&gt;</span><br><span class="line">    &lt;TransitionGroup&gt;</span><br><span class="line">      &lt;CSSTransition key=&#123;location.pathname&#125; classNames=<span class="string">"fade"</span> timeout=&#123;<span class="number">300</span>&#125;&gt;</span><br><span class="line">        &#123; children &#125;</span><br><span class="line">      &lt;<span class="regexp">/CSSTransition&gt;</span></span><br><span class="line"><span class="regexp">    &lt;/</span>TransitionGroup&gt;</span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢ç”¨åˆ°çš„ fade æ ·å¼ï¼Œå¯ä»¥åœ¨ src ä¸‹çš„ global.css é‡Œå®šä¹‰ï¼š</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.fade-enter</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.fade-enter</span><span class="selector-class">.fade-enter-active</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">250ms</span> ease-in;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="é¢åŒ…å±‘"><a href="#é¢åŒ…å±‘" class="headerlink" title="é¢åŒ…å±‘"></a>é¢åŒ…å±‘</h2><p>é¢åŒ…å±‘ä¹Ÿæ˜¯æœ‰å¤šç§å®ç°æ–¹å¼ï¼Œè¿™é‡Œä¸¾ react-router-breadcrumbs-hoc çš„ä¾‹å­ã€‚</p>
<p>å…ˆå®‰è£…ä¾èµ–ï¼Œ</p>
<p>$ yarn add react-router-breadcrumbs-hoc<br>ç„¶åå®ç°ä¸€ä¸ª Breakcrumbs.jsï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> NavLink <span class="keyword">from</span> <span class="string">'umi/navlink'</span>;</span><br><span class="line"><span class="keyword">import</span> withBreadcrumbs <span class="keyword">from</span> <span class="string">'react-router-breadcrumbs-hoc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ›´å¤šé…ç½®è¯·ç§»æ­¥ https://github.com/icd2k3/react-router-breadcrumbs-hoc</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">'/'</span>, <span class="attr">breadcrumb</span>: <span class="string">'é¦–é¡µ'</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">path</span>: <span class="string">'/list'</span>, <span class="attr">breadcrumb</span>: <span class="string">'List Page'</span> &#125;,</span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withBreadcrumbs(routes)(<span class="function">(<span class="params">&#123; breadcrumbs &#125;</span>) =&gt;</span> (</span><br><span class="line">  &lt;div&gt;</span><br><span class="line">    &#123;breadcrumbs.map(<span class="function">(<span class="params">breadcrumb, index</span>) =&gt;</span> (</span><br><span class="line">      &lt;span key=&#123;breadcrumb.key&#125;&gt;</span><br><span class="line">        &lt;NavLink to=&#123;breadcrumb.props.match.url&#125;&gt;</span><br><span class="line">          &#123;breadcrumb&#125;</span><br><span class="line">        &lt;<span class="regexp">/NavLink&gt;</span></span><br><span class="line"><span class="regexp">        &#123;(index &lt; breadcrumbs.length - 1) &amp;&amp; &lt;i&gt; /</span> &lt;<span class="regexp">/i&gt;&#125;</span></span><br><span class="line"><span class="regexp">      &lt;/</span>span&gt;</span><br><span class="line">    ))&#125;</span><br><span class="line">  &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">));</span></span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨éœ€è¦çš„åœ°æ–¹å¼•å…¥æ­¤ React ç»„ä»¶å³å¯ã€‚</p>
<h2 id="å¯ç”¨-Hash-è·¯ç”±"><a href="#å¯ç”¨-Hash-è·¯ç”±" class="headerlink" title="å¯ç”¨ Hash è·¯ç”±"></a>å¯ç”¨ Hash è·¯ç”±</h2><p>umi é»˜è®¤æ˜¯ç”¨çš„ Browser Historyï¼Œå¦‚æœè¦ç”¨ Hash Historyï¼Œéœ€é…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">export default &#123;</span><br><span class="line">  history: &apos;hash&apos;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="Scroll-to-top"><a href="#Scroll-to-top" class="headerlink" title="Scroll to top"></a>Scroll to top</h2><p>åœ¨ layout ç»„ä»¶ï¼ˆlayouts/index.js æˆ–è€… pages å­ç›®å½•ä¸‹çš„ _layout.jsï¼‰çš„ componentDidUpdate é‡Œå†³å®šæ˜¯å¦ scroll to topï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; Component &#125; <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> withRouter <span class="keyword">from</span> <span class="string">'umi/withRouter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Layout</span> <span class="keyword">extends</span> <span class="title">Component</span> </span>&#123;</span><br><span class="line">  componentDidUpdate(prevProps) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.props.location !== prevProps.location) &#123;</span><br><span class="line">      <span class="built_in">window</span>.scrollTo(<span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.props.children;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(Layout);</span><br></pre></td></tr></table></figure>
<h1 id="åœ¨é¡µé¢é—´è·³è½¬"><a href="#åœ¨é¡µé¢é—´è·³è½¬" class="headerlink" title="åœ¨é¡µé¢é—´è·³è½¬"></a>åœ¨é¡µé¢é—´è·³è½¬</h1><p>åœ¨ umi é‡Œï¼Œé¡µé¢ä¹‹é—´è·³è½¬æœ‰ä¸¤ç§æ–¹å¼ï¼šå£°æ˜å¼å’Œå‘½ä»¤å¼ã€‚</p>
<h2 id="å£°æ˜å¼"><a href="#å£°æ˜å¼" class="headerlink" title="å£°æ˜å¼"></a>å£°æ˜å¼</h2><p>åŸºäº umi/linkï¼Œé€šå¸¸ä½œä¸º React ç»„ä»¶ä½¿ç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> Link <span class="keyword">from</span> <span class="string">'umi/link'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> () =&gt; (</span><br><span class="line">  &lt;Link to=<span class="string">"/list"</span>&gt;Go to list page&lt;<span class="regexp">/Link&gt;</span></span><br><span class="line"><span class="regexp">);</span></span><br></pre></td></tr></table></figure>
<h2 id="å‘½ä»¤å¼"><a href="#å‘½ä»¤å¼" class="headerlink" title="å‘½ä»¤å¼"></a>å‘½ä»¤å¼</h2><p>åŸºäº umi/routerï¼Œé€šå¸¸åœ¨äº‹ä»¶å¤„ç†ä¸­è¢«è°ƒç”¨ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'umi/router'</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">goToListPage</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  router.push(<span class="string">'/list'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›´å¤šå‘½ä»¤å¼çš„è·³è½¬æ–¹æ³•ï¼Œè¯¦è§ api#umi/routerã€‚</p>
<h1 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h1><h2 id="é…ç½®æ–‡ä»¶"><a href="#é…ç½®æ–‡ä»¶" class="headerlink" title="é…ç½®æ–‡ä»¶"></a>é…ç½®æ–‡ä»¶</h2><p>umi å…è®¸åœ¨ .umirc.js æˆ– config/config.js ï¼ˆäºŒé€‰ä¸€ï¼Œ.umirc.js ä¼˜å…ˆï¼‰ä¸­è¿›è¡Œé…ç½®ï¼Œæ”¯æŒ ES6 è¯­æ³•ã€‚</p>
<p>ä¸ºç®€åŒ–è¯´æ˜ï¼Œåç»­æ–‡æ¡£é‡Œåªä¼šå‡ºç° .umirc.jsã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  base: <span class="string">'/admin/'</span>,</span><br><span class="line">  publicPath: <span class="string">'http://cdn.com/foo'</span>,</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="string">'umi-plugin-react'</span>, &#123;</span><br><span class="line">      dva: <span class="literal">true</span>,</span><br><span class="line">    &#125;],</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å…·ä½“é…ç½®é¡¹è¯¦è§é…ç½®ã€‚</p>
<h2 id="umirc-local-js"><a href="#umirc-local-js" class="headerlink" title=".umirc.local.js"></a>.umirc.local.js</h2><p>.umirc.local.js æ˜¯æœ¬åœ°çš„é…ç½®æ–‡ä»¶ï¼Œä¸è¦æäº¤åˆ° gitï¼Œæ‰€ä»¥é€šå¸¸éœ€è¦é…ç½®åˆ° .gitignoreã€‚å¦‚æœå­˜åœ¨ï¼Œä¼šå’Œ .umirc.js åˆå¹¶åå†è¿”å›ã€‚</p>
<h2 id="UMI-ENV"><a href="#UMI-ENV" class="headerlink" title="UMI_ENV"></a>UMI_ENV</h2><p>å¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡ UMI_ENV åŒºåˆ†ä¸åŒç¯å¢ƒæ¥æŒ‡å®šé…ç½®ã€‚</p>
<p>ä¸¾ä¸ªä¾‹å­ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// .umirc.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .umirc.cloud.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">b</span>: <span class="string">'cloud'</span>, <span class="attr">c</span>: <span class="string">'cloud'</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// .umirc.local.js</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123; <span class="attr">c</span>: <span class="string">'local'</span> &#125;;</span><br><span class="line">ä¸æŒ‡å®š UMI_ENV æ—¶ï¼Œæ‹¿åˆ°çš„é…ç½®æ˜¯ï¼š</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: <span class="number">2</span>,</span><br><span class="line">  c: <span class="string">'local'</span>,</span><br><span class="line">&#125;</span><br><span class="line">æŒ‡å®š UMI_ENV=cloud æ—¶ï¼Œæ‹¿åˆ°çš„é…ç½®æ˜¯ï¼š</span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line">  a: <span class="number">1</span>,</span><br><span class="line">  b: <span class="string">'cloud'</span>,</span><br><span class="line">  c: <span class="string">'local'</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="HTML-æ¨¡æ¿"><a href="#HTML-æ¨¡æ¿" class="headerlink" title="HTML æ¨¡æ¿"></a>HTML æ¨¡æ¿</h1><h2 id="ä¿®æ”¹é»˜è®¤æ¨¡æ¿"><a href="#ä¿®æ”¹é»˜è®¤æ¨¡æ¿" class="headerlink" title="ä¿®æ”¹é»˜è®¤æ¨¡æ¿"></a>ä¿®æ”¹é»˜è®¤æ¨¡æ¿</h2><p>æ–°å»º src/pages/document.ejsï¼Œumi çº¦å®šå¦‚æœè¿™ä¸ªæ–‡ä»¶å­˜åœ¨ï¼Œä¼šä½œä¸ºé»˜è®¤æ¨¡æ¿ï¼Œå†…å®¹ä¸Šéœ€è¦ä¿è¯æœ‰</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=<span class="string">"root"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Your App<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"root"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®æ¨¡æ¿"><a href="#é…ç½®æ¨¡æ¿" class="headerlink" title="é…ç½®æ¨¡æ¿"></a>é…ç½®æ¨¡æ¿</h2><p>æ¨¡æ¿é‡Œå¯é€šè¿‡ context æ¥è·å–åˆ° umi æä¾›çš„å˜é‡ï¼Œcontext åŒ…å«ï¼š</p>
<p>routeï¼Œè·¯ç”±å¯¹è±¡ï¼ŒåŒ…å« pathã€component ç­‰<br>configï¼Œç”¨æˆ·é…ç½®ä¿¡æ¯<br>publicPath2.1.2+ï¼Œwebpack çš„ output.publicPath é…ç½®<br>envï¼Œç¯å¢ƒå˜é‡ï¼Œå€¼ä¸º development æˆ– production<br>å…¶ä»–åœ¨è·¯ç”±ä¸Šé€šè¿‡ context æ‰©å±•çš„é…ç½®ä¿¡æ¯<br>æ¨¡æ¿åŸºäº ejs æ¸²æŸ“ï¼Œå¯ä»¥å‚è€ƒ <a href="https://github.com/mde/ejs" target="_blank" rel="noopener">https://github.com/mde/ejs</a> æŸ¥çœ‹å…·ä½“ä½¿ç”¨ã€‚</p>
<p>æ¯”å¦‚è¾“å‡ºå˜é‡ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"icon"</span> <span class="attr">type</span>=<span class="string">"image/x-icon"</span> <span class="attr">href</span>=<span class="string">"&lt;%= context.publicPath %&gt;favicon.png"</span> /&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ¯”å¦‚æ¡ä»¶åˆ¤æ–­ï¼Œ</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span>(<span class="attr">context.env</span> === <span class="string">'production'</span>) &#123; %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>ç”Ÿäº§ç¯å¢ƒ<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; <span class="attr">else</span> &#123;%&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>å¼€å‘ç¯å¢ƒ<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> &#125; %&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿"><a href="#é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿" class="headerlink" title="é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿"></a>é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿</h1><p>WARNING</p>
<p>æ­¤åŠŸèƒ½éœ€å¼€å¯ exportStatic é…ç½®ï¼Œå¦åˆ™åªä¼šè¾“å‡ºä¸€ä¸ª html æ–‡ä»¶ã€‚</p>
<p>TIP</p>
<p>ä¼˜å…ˆçº§æ˜¯ï¼šè·¯ç”±çš„ document å±æ€§ &gt; src/pages/document.ejs &gt; umi å†…ç½®æ¨¡æ¿</p>
<p>é…ç½®è·¯ç”±çš„ document å±æ€§ã€‚</p>
<p>æ¯”å¦‚çº¦å®šå¼è·¯ç”±å¯é€šè¿‡æ³¨é‡Šæ‰©å±• document å±æ€§ï¼Œè·¯å¾„ä»é¡¹ç›®æ ¹ç›®å½•å¼€å§‹æ‰¾ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * document: ./src/documents/404.ejs</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åè¿™ä¸ªè·¯ç”±å°±ä¼šä»¥ ./src/documents/404.ejs ä¸ºæ¨¡æ¿è¾“å‡º HTMLã€‚</p>
<h1 id="Mock-æ•°æ®"><a href="#Mock-æ•°æ®" class="headerlink" title="Mock æ•°æ®"></a>Mock æ•°æ®</h1><p>Mock æ•°æ®æ˜¯å‰ç«¯å¼€å‘è¿‡ç¨‹ä¸­å¿…ä¸å¯å°‘çš„ä¸€ç¯ï¼Œæ˜¯åˆ†ç¦»å‰åç«¯å¼€å‘çš„å…³é”®é“¾è·¯ã€‚é€šè¿‡é¢„å…ˆè·ŸæœåŠ¡å™¨ç«¯çº¦å®šå¥½çš„æ¥å£ï¼Œæ¨¡æ‹Ÿè¯·æ±‚æ•°æ®ç”šè‡³é€»è¾‘ï¼Œèƒ½å¤Ÿè®©å‰ç«¯å¼€å‘ç‹¬ç«‹è‡ªä¸»ï¼Œä¸ä¼šè¢«æœåŠ¡ç«¯çš„å¼€å‘æ‰€é˜»å¡ã€‚</p>
<h2 id="ä½¿ç”¨-umi-çš„-mock-åŠŸèƒ½"><a href="#ä½¿ç”¨-umi-çš„-mock-åŠŸèƒ½" class="headerlink" title="ä½¿ç”¨ umi çš„ mock åŠŸèƒ½"></a>ä½¿ç”¨ umi çš„ mock åŠŸèƒ½</h2><p>umi é‡Œçº¦å®š mock æ–‡ä»¶å¤¹ä¸‹çš„æ–‡ä»¶æˆ–è€… page(s) æ–‡ä»¶å¤¹ä¸‹çš„ _mock æ–‡ä»¶å³ mock æ–‡ä»¶ï¼Œæ–‡ä»¶å¯¼å‡ºæ¥å£å®šä¹‰ï¼Œæ”¯æŒåŸºäº require åŠ¨æ€åˆ†æçš„å®æ—¶åˆ·æ–°ï¼Œæ”¯æŒ ES6 è¯­æ³•ï¼Œä»¥åŠå‹å¥½çš„å‡ºé”™æç¤ºï¼Œè¯¦æƒ…å‚çœ‹ mock-dataã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// æ”¯æŒå€¼ä¸º Object å’Œ Array</span></span><br><span class="line">  <span class="string">'GET /api/users'</span>: &#123; <span class="attr">users</span>: [<span class="number">1</span>, <span class="number">2</span>] &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// GET POST å¯çœç•¥</span></span><br><span class="line">  <span class="string">'/api/users/1'</span>: &#123; <span class="attr">id</span>: <span class="number">1</span> &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// æ”¯æŒè‡ªå®šä¹‰å‡½æ•°ï¼ŒAPI å‚è€ƒ express@4</span></span><br><span class="line">  <span class="string">'POST /api/users/create'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123; res.end(<span class="string">'OK'</span>); &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>å½“å®¢æˆ·ç«¯ï¼ˆæµè§ˆå™¨ï¼‰å‘é€è¯·æ±‚ï¼Œå¦‚ï¼šGET /api/usersï¼Œé‚£ä¹ˆæœ¬åœ°å¯åŠ¨çš„ umi dev ä¼šè·Ÿæ­¤é…ç½®æ–‡ä»¶åŒ¹é…è¯·æ±‚è·¯å¾„ä»¥åŠæ–¹æ³•ï¼Œå¦‚æœåŒ¹é…åˆ°äº†ï¼Œå°±ä¼šå°†è¯·æ±‚é€šè¿‡é…ç½®å¤„ç†ï¼Œå°±å¯ä»¥åƒæ ·ä¾‹ä¸€æ ·ï¼Œä½ å¯ä»¥ç›´æ¥è¿”å›æ•°æ®ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å‡½æ•°å¤„ç†ä»¥åŠé‡å®šå‘åˆ°å¦ä¸€ä¸ªæœåŠ¡å™¨ã€‚</p>
<p>æ¯”å¦‚å®šä¹‰å¦‚ä¸‹æ˜ å°„è§„åˆ™ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'GET /api/currentUser'</span>: &#123;</span><br><span class="line">  name: <span class="string">'momo.zxy'</span>,</span><br><span class="line">  avatar: imgMap.user,</span><br><span class="line">  userid: <span class="string">'00000001'</span>,</span><br><span class="line">  notifyCount: <span class="number">12</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>è®¿é—®çš„æœ¬åœ° /api/users æ¥å£ï¼š</p>
<p>è¯·æ±‚å¤´</p>
<p>è¿”å›çš„æ•°æ®</p>
<h2 id="å¼•å…¥-Mock-js"><a href="#å¼•å…¥-Mock-js" class="headerlink" title="å¼•å…¥ Mock.js"></a>å¼•å…¥ Mock.js</h2><p>Mock.js æ˜¯å¸¸ç”¨çš„è¾…åŠ©ç”Ÿæˆæ¨¡æ‹Ÿæ•°æ®çš„ç¬¬ä¸‰æ–¹åº“ï¼Œå½“ç„¶ä½ å¯ä»¥ç”¨ä½ å–œæ¬¢çš„ä»»æ„åº“æ¥ç»“åˆ roadhog æ„å»ºæ•°æ®æ¨¡æ‹ŸåŠŸèƒ½ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mockjs <span class="keyword">from</span> <span class="string">'mockjs'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// ä½¿ç”¨ mockjs ç­‰ä¸‰æ–¹åº“</span></span><br><span class="line">  <span class="string">'GET /api/tags'</span>: mockjs.mock(&#123;</span><br><span class="line">    <span class="string">'list|100'</span>: [&#123; <span class="attr">name</span>: <span class="string">'@city'</span>, <span class="string">'value|1-100'</span>: <span class="number">50</span>, <span class="string">'type|0-2'</span>: <span class="number">1</span> &#125;],</span><br><span class="line">  &#125;),</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´"><a href="#æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´" class="headerlink" title="æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´"></a>æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´</h2><p>è®¾ç½® response çš„è¯·æ±‚å¤´å³å¯ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'POST /api/users/create'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  ...</span><br><span class="line">  res.setHeader(<span class="string">'Access-Control-Allow-Origin'</span>, <span class="string">'*'</span>);</span><br><span class="line">  ...</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="åˆç†çš„æ‹†åˆ†ä½ çš„-mock-æ–‡ä»¶"><a href="#åˆç†çš„æ‹†åˆ†ä½ çš„-mock-æ–‡ä»¶" class="headerlink" title="åˆç†çš„æ‹†åˆ†ä½ çš„ mock æ–‡ä»¶"></a>åˆç†çš„æ‹†åˆ†ä½ çš„ mock æ–‡ä»¶</h2><p>å¯¹äºæ•´ä¸ªç³»ç»Ÿæ¥è¯´ï¼Œè¯·æ±‚æ¥å£æ˜¯å¤æ‚å¹¶ä¸”ç¹å¤šçš„ï¼Œä¸ºäº†å¤„ç†å¤§é‡æ¨¡æ‹Ÿè¯·æ±‚çš„åœºæ™¯ï¼Œæˆ‘ä»¬é€šå¸¸æŠŠæ¯ä¸€ä¸ªæ•°æ®æ¨¡å‹æŠ½è±¡æˆä¸€ä¸ªæ–‡ä»¶ï¼Œç»Ÿä¸€æ”¾åœ¨ mock çš„æ–‡ä»¶å¤¹ä¸­ï¼Œç„¶åä»–ä»¬ä¼šè‡ªåŠ¨è¢«å¼•å…¥ã€‚</p>
<h2 id="å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ"><a href="#å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ" class="headerlink" title="å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ"></a>å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ</h2><p>ä¸ºäº†æ›´åŠ çœŸå®çš„æ¨¡æ‹Ÿç½‘ç»œæ•°æ®è¯·æ±‚ï¼Œå¾€å¾€éœ€è¦æ¨¡æ‹Ÿç½‘ç»œå»¶è¿Ÿæ—¶é—´ã€‚</p>
<h2 id="æ‰‹åŠ¨æ·»åŠ -setTimeout-æ¨¡æ‹Ÿå»¶è¿Ÿ"><a href="#æ‰‹åŠ¨æ·»åŠ -setTimeout-æ¨¡æ‹Ÿå»¶è¿Ÿ" class="headerlink" title="æ‰‹åŠ¨æ·»åŠ  setTimeout æ¨¡æ‹Ÿå»¶è¿Ÿ"></a>æ‰‹åŠ¨æ·»åŠ  setTimeout æ¨¡æ‹Ÿå»¶è¿Ÿ</h2><p>ä½ å¯ä»¥åœ¨é‡å†™è¯·æ±‚çš„ä»£ç†æ–¹æ³•ï¼Œåœ¨å…¶ä¸­æ·»åŠ æ¨¡æ‹Ÿå»¶è¿Ÿçš„å¤„ç†ï¼Œå¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">'POST /api/forms'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    res.send(<span class="string">'Ok'</span>);</span><br><span class="line">  &#125;, <span class="number">1000</span>);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ"><a href="#ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ" class="headerlink" title="ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ"></a>ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ</h2><p>ä¸Šé¢çš„æ–¹æ³•è™½ç„¶ç®€ä¾¿ï¼Œä½†æ˜¯å½“ä½ éœ€è¦æ·»åŠ æ‰€æœ‰çš„è¯·æ±‚å»¶è¿Ÿçš„æ—¶å€™ï¼Œå¯èƒ½å°±éº»çƒ¦äº†ï¼Œä¸è¿‡å¯ä»¥é€šè¿‡ç¬¬ä¸‰æ–¹æ’ä»¶æ¥ç®€åŒ–è¿™ä¸ªé—®é¢˜ï¼Œå¦‚ï¼šroadhog-api-doc#delayã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; delay &#125; <span class="keyword">from</span> <span class="string">'roadhog-api-doc'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> proxy = &#123;</span><br><span class="line">  <span class="string">'GET /api/project/notice'</span>: getNotice,</span><br><span class="line">  <span class="string">'GET /api/activities'</span>: getActivities,</span><br><span class="line">  <span class="string">'GET /api/rule'</span>: getRule,</span><br><span class="line">  <span class="string">'GET /api/tags'</span>: mockjs.mock(&#123;</span><br><span class="line">    <span class="string">'list|100'</span>: [&#123; <span class="attr">name</span>: <span class="string">'@city'</span>, <span class="string">'value|1-100'</span>: <span class="number">50</span>, <span class="string">'type|0-2'</span>: <span class="number">1</span> &#125;]</span><br><span class="line">  &#125;),</span><br><span class="line">  <span class="string">'GET /api/fake_list'</span>: getFakeList,</span><br><span class="line">  <span class="string">'GET /api/fake_chart_data'</span>: getFakeChartData,</span><br><span class="line">  <span class="string">'GET /api/profile/basic'</span>: getProfileBasicData,</span><br><span class="line">  <span class="string">'GET /api/profile/advanced'</span>: getProfileAdvancedData,</span><br><span class="line">  <span class="string">'POST /api/register'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    res.send(&#123; <span class="attr">status</span>: <span class="string">'ok'</span> &#125;);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="string">'GET /api/notices'</span>: getNotices,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>// è°ƒç”¨ delay å‡½æ•°ï¼Œç»Ÿä¸€å¤„ç†</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> delay(proxy, <span class="number">1000</span>);</span><br></pre></td></tr></table></figure>
<h2 id="åŠ¨æ€-Mock-æ•°æ®"><a href="#åŠ¨æ€-Mock-æ•°æ®" class="headerlink" title="åŠ¨æ€ Mock æ•°æ®"></a>åŠ¨æ€ Mock æ•°æ®</h2><p>å¦‚æœä½ éœ€è¦åŠ¨æ€ç”Ÿæˆ Mock æ•°æ®ï¼Œä½ åº”è¯¥é€šè¿‡å‡½æ•°è¿›è¡Œå¤„ç†ï¼Œ</p>
<p>æ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// é™æ€çš„</span></span><br><span class="line"><span class="string">'/api/random'</span>: Mock.mock(&#123;</span><br><span class="line">  <span class="comment">// åªéšæœºä¸€æ¬¡</span></span><br><span class="line">  <span class="string">'number|1-100'</span>: <span class="number">100</span>,</span><br><span class="line">&#125;),</span><br><span class="line"><span class="comment">// åŠ¨æ€çš„</span></span><br><span class="line"><span class="string">'/api/random'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">  res.send(Mock.mock(&#123;</span><br><span class="line">    <span class="comment">// æ¯æ¬¡è¯·æ±‚å‡äº§ç”Ÿéšæœºå€¼</span></span><br><span class="line">    <span class="string">'number|1-100'</span>: <span class="number">100</span>,</span><br><span class="line">  &#125;))</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<h2 id="è”è°ƒ"><a href="#è”è°ƒ" class="headerlink" title="è”è°ƒ"></a>è”è°ƒ</h2><p>å½“æœ¬åœ°å¼€å‘å®Œæ¯•ä¹‹åï¼Œå¦‚æœæœåŠ¡å™¨çš„æ¥å£æ»¡è¶³ä¹‹å‰çš„çº¦å®šï¼Œé‚£ä¹ˆä½ åªéœ€è¦ä¸å¼€æœ¬åœ°ä»£ç†æˆ–è€…é‡å®šå‘ä»£ç†åˆ°ç›®æ ‡æœåŠ¡å™¨å°±å¯ä»¥è®¿é—®çœŸå®çš„æœåŠ¡ç«¯æ•°æ®ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p>
<h1 id="Use-umi-with-dva-é‡ç‚¹"><a href="#Use-umi-with-dva-é‡ç‚¹" class="headerlink" title="Use umi with dva(é‡ç‚¹)"></a>Use umi with dva(é‡ç‚¹)</h1><p>è‡ª&gt;= umi@2èµ·ï¼Œdvaçš„æ•´åˆå¯ä»¥ç›´æ¥é€šè¿‡ umi-plugin-react æ¥é…ç½®ã€‚</p>
<h2 id="ç‰¹æ€§-1"><a href="#ç‰¹æ€§-1" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h2><p>æŒ‰ç›®å½•çº¦å®šæ³¨å†Œ modelï¼Œæ— éœ€æ‰‹åŠ¨ app.model<br>æ–‡ä»¶åå³ namespaceï¼Œå¯ä»¥çœå» model å¯¼å‡ºçš„ namespace key<br>æ— éœ€æ‰‹å†™ router.jsï¼Œäº¤ç»™ umi å¤„ç†ï¼Œæ”¯æŒ model å’Œ component çš„æŒ‰éœ€åŠ è½½<br>å†…ç½® query-string å¤„ç†ï¼Œæ— éœ€å†æ‰‹åŠ¨è§£ç å’Œç¼–ç <br>å†…ç½® dva-loading å’Œ dva-immerï¼Œå…¶ä¸­ dva-immer éœ€é€šè¿‡é…ç½®å¼€å¯<br>å¼€ç®±å³ç”¨ï¼Œæ— éœ€å®‰è£…é¢å¤–ä¾èµ–ï¼Œæ¯”å¦‚ dvaã€dva-loadingã€dva-immerã€path-to-regexpã€object-assignã€reactã€react-dom ç­‰</p>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><p>ç”¨ yarn å®‰è£…ä¾èµ–ï¼Œ</p>
<p>$ yarn add umi-plugin-react<br>å¦‚æœä½ ç”¨ npmï¼Œæ‰§è¡Œ npm install â€“save umi-plugin-reactã€‚</p>
<p>ç„¶ååœ¨ .umirc.js é‡Œé…ç½®æ’ä»¶ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'umi-plugin-react'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        dva: <span class="literal">true</span>,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>æ¨èå¼€å¯ dva-immer ä»¥ç®€åŒ– reducer ç¼–å†™ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'umi-plugin-react'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        dva: &#123;</span><br><span class="line">          immer: <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="model-æ³¨å†Œ"><a href="#model-æ³¨å†Œ" class="headerlink" title="model æ³¨å†Œ"></a>model æ³¨å†Œ</h2><p>model åˆ†ä¸¤ç±»ï¼Œä¸€æ˜¯å…¨å±€ modelï¼ŒäºŒæ˜¯é¡µé¢ modelã€‚å…¨å±€ model å­˜äº /src/models/ ç›®å½•ï¼Œæ‰€æœ‰é¡µé¢éƒ½å¯å¼•ç”¨ï¼›é¡µé¢ model ä¸èƒ½è¢«å…¶ä»–é¡µé¢æ‰€å¼•ç”¨ã€‚</p>
<p>è§„åˆ™å¦‚ä¸‹ï¼š</p>
<blockquote>
<p>src/models/<strong>/*.js ä¸º global model<br>src/pages/</strong>/models/<strong>/*.js ä¸º page model<br>global model å…¨é‡è½½å…¥ï¼Œpage model åœ¨ production æ—¶æŒ‰éœ€è½½å…¥ï¼Œåœ¨ development æ—¶å…¨é‡è½½å…¥<br>page model ä¸º page js æ‰€åœ¨è·¯å¾„ä¸‹ models/</strong>/<em>.js çš„æ–‡ä»¶<br>page model ä¼šå‘ä¸ŠæŸ¥æ‰¾ï¼Œæ¯”å¦‚ page js ä¸º pages/a/b.jsï¼Œä»–çš„ page model ä¸º pages/a/b/models/**/</em>.js + pages/a/models/<strong>/*.jsï¼Œä¾æ¬¡ç±»æ¨<br>çº¦å®š model.js ä¸ºå•æ–‡ä»¶ modelï¼Œè§£å†³åªæœ‰ä¸€ä¸ª model æ—¶ä¸éœ€è¦å»º models ç›®å½•çš„é—®é¢˜ï¼Œæœ‰ model.js åˆ™ä¸å»æ‰¾ models/</strong>/*.js<br>ä¸¾ä¸ªä¾‹å­ï¼Œ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">+ src</span><br><span class="line">  + models</span><br><span class="line">    - g.js</span><br><span class="line">  + pages</span><br><span class="line">    + a</span><br><span class="line">      + models</span><br><span class="line">        - a.js</span><br><span class="line">        - b.js</span><br><span class="line">        + ss</span><br><span class="line">          - s.js</span><br><span class="line">      - page.js</span><br><span class="line">    + c</span><br><span class="line">      - model.js</span><br><span class="line">      + d</span><br><span class="line">        + models</span><br><span class="line">          - d.js</span><br><span class="line">        - page.js</span><br><span class="line">      - page.js</span><br></pre></td></tr></table></figure>
<p>å¦‚ä¸Šç›®å½•ï¼š</p>
<blockquote>
<p>global model ä¸º src/models/g.js<br>/a çš„ page model ä¸º src/pages/a/models/{a,b,ss/s}.js<br>/c çš„ page model ä¸º src/pages/c/model.js<br>/c/d çš„ page model ä¸º src/pages/c/model.js, src/pages/c/d/models/d.js</p>
</blockquote>
<h2 id="é…ç½®åŠæ’ä»¶"><a href="#é…ç½®åŠæ’ä»¶" class="headerlink" title="é…ç½®åŠæ’ä»¶"></a>é…ç½®åŠæ’ä»¶</h2><p>ä¹‹å‰åœ¨ src/dva.js ä¸‹è¿›è¡Œé…ç½®çš„æ–¹å¼å·² deprecatedï¼Œä¸‹ä¸ªå¤§ç‰ˆæœ¬ä¼šç§»é™¤æ”¯æŒã€‚</p>
<p>åœ¨ src ç›®å½•ä¸‹æ–°å»º app.jsï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> dva = &#123;</span><br><span class="line">  config: &#123;</span><br><span class="line">    onError(e) &#123;</span><br><span class="line">      e.preventDefault();</span><br><span class="line">      <span class="built_in">console</span>.error(e.message);</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">  plugins: [</span><br><span class="line">    <span class="built_in">require</span>(<span class="string">'dva-logger'</span>)(),</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="FAQ"><a href="#FAQ" class="headerlink" title="FAQ"></a>FAQ</h2><h3 id="url-å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"><a href="#url-å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ" class="headerlink" title="url å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"></a>url å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</h3><p>layouts/index.js é‡Œå¦‚æœç”¨äº† connect ä¼ æ•°æ®ï¼Œéœ€è¦ç”¨ umi/withRouter é«˜é˜¶ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> withRouter <span class="keyword">from</span> <span class="string">'umi/withRouter'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(connect(mapStateToProps)(LayoutComponent));</span><br></pre></td></tr></table></figure>
<h3 id="å¦‚ä½•è®¿é—®åˆ°-store-æˆ–-dispatch-æ–¹æ³•ï¼Ÿ"><a href="#å¦‚ä½•è®¿é—®åˆ°-store-æˆ–-dispatch-æ–¹æ³•ï¼Ÿ" class="headerlink" title="å¦‚ä½•è®¿é—®åˆ° store æˆ– dispatch æ–¹æ³•ï¼Ÿ"></a>å¦‚ä½•è®¿é—®åˆ° store æˆ– dispatch æ–¹æ³•ï¼Ÿ</h3><p>window.g_app._store<br>window.g_app._store.dispatch</p>
<h3 id="å¦‚ä½•ç¦ç”¨åŒ…æ‹¬-component-å’Œ-models-çš„æŒ‰éœ€åŠ è½½ï¼Ÿ"><a href="#å¦‚ä½•ç¦ç”¨åŒ…æ‹¬-component-å’Œ-models-çš„æŒ‰éœ€åŠ è½½ï¼Ÿ" class="headerlink" title="å¦‚ä½•ç¦ç”¨åŒ…æ‹¬ component å’Œ models çš„æŒ‰éœ€åŠ è½½ï¼Ÿ"></a>å¦‚ä½•ç¦ç”¨åŒ…æ‹¬ component å’Œ models çš„æŒ‰éœ€åŠ è½½ï¼Ÿ</h3><p>åœ¨ .umirc.js é‡Œé…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    [</span><br><span class="line">      <span class="string">'umi-plugin-react'</span>,</span><br><span class="line">      &#123;</span><br><span class="line">        dva: &#123;</span><br><span class="line">          dynamicImport: <span class="literal">undefined</span> <span class="comment">// é…ç½®åœ¨dvaé‡Œ</span></span><br><span class="line">        &#125;,</span><br><span class="line">        dynamicImport: <span class="literal">undefined</span>   <span class="comment">// æˆ–è€…ç›´æ¥å†™åœ¨reactæ’ä»¶çš„æ ¹é…ç½®ï¼Œå†™åœ¨è¿™é‡Œä¹Ÿä¼šè¢«ç»§æ‰¿åˆ°ä¸Šé¢çš„dvaé…ç½®é‡Œ</span></span><br><span class="line">      &#125;</span><br><span class="line">    ],</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="å…¨å±€-layout-ä½¿ç”¨-connect-åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ"><a href="#å…¨å±€-layout-ä½¿ç”¨-connect-åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ" class="headerlink" title="å…¨å±€ layout ä½¿ç”¨ connect åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ"></a>å…¨å±€ layout ä½¿ç”¨ connect åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ</h3><p>éœ€ç”¨ withRouter åŒ…ä¸€ä¸‹å¯¼å‡ºçš„ react ç»„ä»¶ï¼Œæ³¨æ„é¡ºåºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> withRouter <span class="keyword">from</span> <span class="string">'umi/withRouter'</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> withRouter(connect()(Layout));</span><br></pre></td></tr></table></figure>
<h1 id="æŒ‰éœ€åŠ è½½"><a href="#æŒ‰éœ€åŠ è½½" class="headerlink" title="æŒ‰éœ€åŠ è½½"></a>æŒ‰éœ€åŠ è½½</h1><p>å‡ºäºæ€§èƒ½çš„è€ƒè™‘ï¼Œæˆ‘ä»¬ä¼šå¯¹æ¨¡å—å’Œç»„ä»¶è¿›è¡ŒæŒ‰éœ€åŠ è½½ã€‚</p>
<h2 id="æŒ‰éœ€åŠ è½½ç»„ä»¶"><a href="#æŒ‰éœ€åŠ è½½ç»„ä»¶" class="headerlink" title="æŒ‰éœ€åŠ è½½ç»„ä»¶"></a>æŒ‰éœ€åŠ è½½ç»„ä»¶</h2><p>é€šè¿‡ umi/dynamic æ¥å£å®ç°ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> dynamic <span class="keyword">from</span> <span class="string">'umi/dynamic'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> delay = <span class="function">(<span class="params">timeout</span>) =&gt;</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> setTimeout(resolve, timeout));</span><br><span class="line"><span class="keyword">const</span> App = dynamic(&#123;</span><br><span class="line">  loader: <span class="keyword">async</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">await</span> delay(<span class="comment">/* 1s */</span><span class="number">1000</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="params">()</span> =&gt;</span> &lt;div&gt;I will render after <span class="number">1</span>s&lt;<span class="regexp">/div&gt;;</span></span><br><span class="line"><span class="regexp">  &#125;,</span></span><br><span class="line"><span class="regexp">&#125;);</span></span><br></pre></td></tr></table></figure>
<h2 id="æŒ‰éœ€åŠ è½½æ¨¡å—"><a href="#æŒ‰éœ€åŠ è½½æ¨¡å—" class="headerlink" title="æŒ‰éœ€åŠ è½½æ¨¡å—"></a>æŒ‰éœ€åŠ è½½æ¨¡å—</h2><p>é€šè¿‡ import() å®ç°ï¼Œæ¯”å¦‚ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>(<span class="string">'g2'</span>).then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// do something with g2</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<h1 id="è¿è¡Œæ—¶é…ç½®"><a href="#è¿è¡Œæ—¶é…ç½®" class="headerlink" title="è¿è¡Œæ—¶é…ç½®"></a>è¿è¡Œæ—¶é…ç½®</h1><h2 id="ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ"><a href="#ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ" class="headerlink" title="ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ"></a>ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ</h2><p>æˆ‘ä»¬é€šè¿‡ .umirc.js åšç¼–è¯‘æ—¶çš„é…ç½®ï¼Œè¿™èƒ½è¦†ç›–å¤§é‡åœºæ™¯ï¼Œä½†æœ‰ä¸€äº›å´æ˜¯ç¼–è¯‘æ—¶å¾ˆéš¾è§¦åŠçš„ã€‚</p>
<p>æ¯”å¦‚ï¼š</p>
<p>åœ¨å‡ºé”™æ—¶æ˜¾ç¤ºä¸ª message æç¤ºç”¨æˆ·<br>åœ¨åŠ è½½å’Œè·¯ç”±åˆ‡æ¢æ—¶æ˜¾ç¤ºä¸ª loading<br>é¡µé¢è½½å…¥å®Œæˆæ—¶è¯·æ±‚åç«¯ï¼Œæ ¹æ®å“åº”åŠ¨æ€ä¿®æ”¹è·¯ç”±<br>è¿™äº›åœ¨ç¼–è¯‘æ—¶å°±å¾ˆéš¾å¤„ç†ï¼Œæˆ–è€…ä¸èƒ½å¤„ç†äº†ã€‚</p>
<h2 id="é…ç½®æ–¹å¼"><a href="#é…ç½®æ–¹å¼" class="headerlink" title="é…ç½®æ–¹å¼"></a>é…ç½®æ–¹å¼</h2><p>umi çº¦å®š src ç›®å½•ä¸‹çš„ app.js ä¸ºè¿è¡Œæ—¶çš„é…ç½®æ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">+ src</span><br><span class="line">  - app.js      <span class="comment"># è¿è¡Œæ—¶é…ç½®æ–‡ä»¶</span></span><br><span class="line">- package.json</span><br></pre></td></tr></table></figure>
<h2 id="é…ç½®åˆ—è¡¨"><a href="#é…ç½®åˆ—è¡¨" class="headerlink" title="é…ç½®åˆ—è¡¨"></a>é…ç½®åˆ—è¡¨</h2><h3 id="patchRoutes"><a href="#patchRoutes" class="headerlink" title="patchRoutes"></a>patchRoutes</h3><p>ç”¨äºè¿è¡Œæ—¶ä¿®æ”¹è·¯ç”±ã€‚</p>
<blockquote>
<p>å‚æ•°ï¼š<br>routes: Arrayï¼Œè·¯ç”±é…ç½®<br>e.g. æ·»åŠ ä¸€ä¸ª /foo çš„è·¯ç”±ï¼Œ</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> <span class="keyword">function</span> patchRoutes(routes) &#123;</span><br><span class="line">  routes[0].unshift(&#123;</span><br><span class="line">    path: <span class="string">'/foo'</span>,</span><br><span class="line">    component: require(<span class="string">'./routes/foo'</span>).default,</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯èƒ½çš„åœºæ™¯ï¼š<br>å’Œ render é…åˆä½¿ç”¨ï¼Œè¯·æ±‚æœåŠ¡ç«¯æ ¹æ®å“åº”åŠ¨æ€æ›´æ–°è·¯ç”±<br>ä¿®æ”¹å…¨éƒ¨è·¯ç”±ï¼ŒåŠ ä¸ŠæŸä¸ªå‰ç¼€<br>â€¦<br>æ³¨ï¼š</p>
<p>åŒæ ·é€‚ç”¨çº¦å®šå¼è·¯ç”±<br>ç›´æ¥ä¿®æ”¹ routes å°±å¥½ï¼Œä¸è¦è¿”å›æ–°çš„è·¯ç”±å¯¹è±¡</p>
<h3 id="render"><a href="#render" class="headerlink" title="render"></a>render</h3><p>ç”¨äºæ”¹å†™æŠŠæ•´ä¸ªåº”ç”¨ render åˆ° dom æ ‘é‡Œçš„æ–¹æ³•ã€‚</p>
<p>å‚æ•°ï¼š<br>oldRenderï¼Œ Functionï¼ŒåŸå§‹ render æ–¹æ³•ï¼Œéœ€è‡³å°‘è¢«è°ƒç”¨ä¸€æ¬¡<br>e.g. å»¶è¿Ÿ 1s æ¸²æŸ“åº”ç”¨ï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">render</span>(<span class="params">oldRender</span>) </span>&#123;</span><br><span class="line">  setTimeout(oldRender, <span class="number">1000</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¯èƒ½çš„åœºæ™¯ï¼šæ¸²æŸ“åº”ç”¨ä¹‹å‰åšæƒé™æ ¡éªŒï¼Œä¸é€šè¿‡åˆ™è·³è½¬åˆ°ç™»å½•é¡µ</p>
<h3 id="onRouteChange"><a href="#onRouteChange" class="headerlink" title="onRouteChange"></a>onRouteChange</h3><p>ç”¨äºåœ¨åˆå§‹åŠ è½½å’Œè·¯ç”±åˆ‡æ¢æ—¶åšä¸€äº›äº‹æƒ…ã€‚</p>
<blockquote>
<p>å‚æ•°ï¼š<br>Object<br>locationï¼šObject, history æä¾›çš„ location å¯¹è±¡<br>routes: Array, è·¯ç”±é…ç½®<br>action: PUSH|POP|REPLACE|undefinedï¼Œåˆæ¬¡åŠ è½½æ—¶ä¸º undefined<br>e.g.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">onRouteChange</span>(<span class="params">&#123; location, routes, action &#125;</span>) </span>&#123;</span><br><span class="line">  bacon(location.pathname);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯èƒ½çš„åœºæ™¯ï¼šåŸ‹ç‚¹ç»Ÿè®¡<br>æ³¨ï¼šåˆæ¬¡åŠ è½½æ—¶ä¹Ÿä¼šæ‰§è¡Œï¼Œä½† action ä¸º undefined</p>
</blockquote>
<h3 id="rootContainer"><a href="#rootContainer" class="headerlink" title="rootContainer"></a>rootContainer</h3><p>ç”¨äºå°è£… root containerï¼Œå¯ä»¥å–ä¸€éƒ¨åˆ†ï¼Œæˆ–è€…å¤–é¢å¥—ä¸€å±‚ï¼Œç­‰ç­‰ã€‚</p>
<blockquote>
<p>å‚æ•°ï¼šcontainerï¼ŒReactComponentï¼ŒReact åº”ç”¨æœ€ä¸Šå±‚çš„æ ¹ç»„ä»¶ e.g.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">rootContainer</span>(<span class="params">container</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">const</span> DvaContainer = <span class="built_in">require</span>(<span class="string">'@tmp/DvaContainer'</span>).default;</span><br><span class="line">  <span class="keyword">return</span> React.createElement(DvaContainer, <span class="literal">null</span>, container);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å¯èƒ½çš„åœºæ™¯ï¼šdvaã€intl ç­‰éœ€è¦åœ¨å¤–å±‚æœ‰ä¸ª Provider çš„åœºæ™¯</p>
</blockquote>
<h3 id="modifyRouteProps"><a href="#modifyRouteProps" class="headerlink" title="modifyRouteProps"></a>modifyRouteProps</h3><p>ä¿®æ”¹ä¼ ç»™è·¯ç”±ç»„ä»¶çš„ propsã€‚</p>
<blockquote>
<p>å‚æ•°ï¼š<br>propsï¼ŒObjectï¼ŒåŸå§‹ props<br>Object<br>routeï¼ŒObjectï¼Œå½“å‰è·¯ç”±é…ç½®<br>e.g.</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">modifyRouteProps</span>(<span class="params">props, &#123; route &#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> &#123; ...props, <span class="attr">foo</span>: <span class="string">'bar'</span> &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ³¨ï¼šéœ€è¿”å›æ–°çš„ props</p>
</blockquote>
<h1 id="åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰"><a href="#åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰" class="headerlink" title="åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰"></a>åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰</h1><p>åœ¨ umi ä¸­ï¼ŒåŒºå—æ˜¯æŒ‡é¡µé¢çº§åˆ«çš„å¯å¤ç”¨çš„ä»£ç ã€‚umi å®šä¹‰äº†ä¸€ä¸ªåŒºå—çš„è§„èŒƒï¼Œä½ å¯ä»¥é€šè¿‡ umi èƒ½å¤Ÿå¿«é€Ÿç®€å•çš„åœ¨ä½ çš„é¡¹ç›®ä¸­æ·»åŠ åŒºå—ï¼Œç”¨äºå¿«é€Ÿçš„å¼€å§‹ä¸€ä¸ªé¡µé¢çš„å¼€å‘ã€‚</p>
<h1 id="éƒ¨ç½²"><a href="#éƒ¨ç½²" class="headerlink" title="éƒ¨ç½²"></a>éƒ¨ç½²</h1><h2 id="é»˜è®¤æ–¹æ¡ˆ"><a href="#é»˜è®¤æ–¹æ¡ˆ" class="headerlink" title="é»˜è®¤æ–¹æ¡ˆ"></a>é»˜è®¤æ–¹æ¡ˆ</h2><p>umi@2 é»˜è®¤å¯¹æ–°æ‰‹å‹å¥½ï¼Œæ‰€ä»¥é»˜è®¤ä¸åšæŒ‰éœ€åŠ è½½å¤„ç†ï¼Œumi build åè¾“å‡º index.htmlã€umi.js å’Œ umi.css ä¸‰ä¸ªæ–‡ä»¶ã€‚</p>
<h2 id="ä¸è¾“å‡º-html-æ–‡ä»¶"><a href="#ä¸è¾“å‡º-html-æ–‡ä»¶" class="headerlink" title="ä¸è¾“å‡º html æ–‡ä»¶"></a>ä¸è¾“å‡º html æ–‡ä»¶</h2><p>æŸäº›åœºæ™¯ html æ–‡ä»¶äº¤ç»™åç«¯è¾“å‡ºï¼Œå‰ç«¯æ„å»ºå¹¶ä¸éœ€è¦è¾“å‡º html æ–‡ä»¶ï¼Œå¯é…ç½®ç¯å¢ƒå˜é‡ HTML=none å®ç°ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ HTML=none umi build</span><br></pre></td></tr></table></figure>
<h2 id="éƒ¨ç½²-html-åˆ°éæ ¹ç›®å½•"><a href="#éƒ¨ç½²-html-åˆ°éæ ¹ç›®å½•" class="headerlink" title="éƒ¨ç½² html åˆ°éæ ¹ç›®å½•"></a>éƒ¨ç½² html åˆ°éæ ¹ç›®å½•</h2><p>ç»å¸¸æœ‰åŒå­¦é—®è¿™ä¸ªé—®é¢˜ï¼š</p>
<p>ä¸ºä»€ä¹ˆæˆ‘æœ¬åœ°å¼€å‘æ˜¯å¥½çš„ï¼Œéƒ¨ç½²åå°±æ²¡ååº”äº†ï¼Œè€Œä¸”æ²¡æœ‰æŠ¥é”™ï¼Ÿ</p>
<p>æ²¡æœ‰æŠ¥é”™ï¼ è¿™æ˜¯åº”ç”¨éƒ¨ç½²åœ¨éæ ¹è·¯å¾„çš„å…¸å‹ç°è±¡ã€‚ä¸ºå•¥ä¼šæœ‰è¿™ä¸ªé—®é¢˜ï¼Ÿå› ä¸ºè·¯ç”±æ²¡æœ‰åŒ¹é…ä¸Šï¼Œæ¯”å¦‚ä½ æŠŠåº”ç”¨éƒ¨ç½²åœ¨ /xxx/ ä¸‹ï¼Œç„¶åè®¿é—® /xxx/helloï¼Œè€Œä»£ç é‡ŒåŒ¹é…çš„æ˜¯ /helloï¼Œé‚£å°±åŒ¹é…ä¸ä¸Šäº†ï¼Œè€Œåˆæ²¡æœ‰å®šä¹‰ fallback çš„è·¯ç”±ï¼Œæ¯”å¦‚ 404ï¼Œé‚£å°±ä¼šæ˜¾ç¤ºç©ºç™½é¡µã€‚</p>
<p>æ€ä¹ˆè§£å†³ï¼Ÿ</p>
<p>å¯é€šè¿‡é…ç½® base è§£å†³ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  base: <span class="string">'/path/to/your/app/root'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨-hashHistory"><a href="#ä½¿ç”¨-hashHistory" class="headerlink" title="ä½¿ç”¨ hashHistory"></a>ä½¿ç”¨ hashHistory</h2><p>å¯é€šè¿‡é…ç½® history ä¸º hash ä¸ºè§£å†³ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  history: <span class="string">'hash'</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="æŒ‰éœ€åŠ è½½-1"><a href="#æŒ‰éœ€åŠ è½½-1" class="headerlink" title="æŒ‰éœ€åŠ è½½"></a>æŒ‰éœ€åŠ è½½</h2><p>è¦å®ç°æŒ‰éœ€åŠ è½½ï¼Œéœ€è£…è½½ umi-plugin-react æ’ä»¶å¹¶é…ç½® dynamicImportã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  plugins: [</span><br><span class="line">    [<span class="string">'umi-plugin-react'</span>, &#123;</span><br><span class="line">      dynamicImport: <span class="literal">true</span>,</span><br><span class="line">    &#125;],</span><br><span class="line">  ],</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>å‚æ•°è¯¦è§ï¼šumi-plugin-react#dynamicImportã€‚</p>
</blockquote>
<h2 id="é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ–-cdn"><a href="#é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ–-cdn" class="headerlink" title="é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ– cdn"></a>é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ– cdn</h2><p>è¿™æ—¶ï¼Œå°±éœ€è¦é…ç½® publicPathã€‚è‡³äº publicPath æ˜¯å•¥ï¼Ÿå…·ä½“çœ‹ webpack æ–‡æ¡£ï¼ŒæŠŠä»–æŒ‡å‘é™æ€èµ„æºï¼ˆjsã€cssã€å›¾ç‰‡ã€å­—ä½“ç­‰ï¼‰æ‰€åœ¨çš„è·¯å¾„ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  publicPath: <span class="string">"http://yourcdn/path/to/static/"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="ä½¿ç”¨-runtime-çš„-publicPath"><a href="#ä½¿ç”¨-runtime-çš„-publicPath" class="headerlink" title="ä½¿ç”¨ runtime çš„ publicPath"></a>ä½¿ç”¨ runtime çš„ publicPath</h2><p>å¯¹äºéœ€è¦åœ¨ html é‡Œç®¡ç† publicPath çš„åœºæ™¯ï¼Œæ¯”å¦‚åœ¨ html é‡Œåˆ¤æ–­ç¯å¢ƒåšä¸åŒçš„è¾“å‡ºï¼Œå¯é€šè¿‡é…ç½® runtimePublicPath ä¸ºè§£å†³ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  runtimePublicPath: <span class="literal">true</span>,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>ç„¶ååœ¨ html é‡Œè¾“å‡ºï¼š</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="built_in">window</span>.publicPath = <span class="xml"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">YOUR</span> <span class="attr">PUBLIC_PATH</span> %&gt;</span></span></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="é™æ€åŒ–"><a href="#é™æ€åŒ–" class="headerlink" title="é™æ€åŒ–"></a>é™æ€åŒ–</h2><p>åœ¨ä¸€äº›åœºæ™¯ä¸­ï¼Œæ— æ³•åšæœåŠ¡ç«¯çš„ html fallbackï¼Œå³è®©æ¯ä¸ªè·¯ç”±éƒ½è¾“å‡º index.html çš„å†…å®¹ï¼Œé‚£ä¹ˆå°±è¦åšé™æ€åŒ–ã€‚</p>
<p>æ¯”å¦‚ä¸Šé¢çš„ä¾‹å­ï¼Œæˆ‘ä»¬åœ¨ .umirc.js é‡Œé…ç½®ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  exportStatic: &#123;&#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ‰§è¡Œ umi buildï¼Œä¼šä¸ºæ¯ä¸ªè·¯ç”±è¾“å‡ºä¸€ä¸ª html æ–‡ä»¶ã€‚</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">./dist</span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ list</span><br><span class="line">â”‚   â””â”€â”€ index.html</span><br><span class="line">â””â”€â”€ static</span><br><span class="line">    â”œâ”€â”€ pages__index.5c0f5f51.async.js</span><br><span class="line">    â”œâ”€â”€ pages__list.f940b099.async.js</span><br><span class="line">    â”œâ”€â”€ umi.2eaebd79.js</span><br><span class="line">    â””â”€â”€ umi.f4cb51da.css</span><br></pre></td></tr></table></figure>
<p>æ³¨æ„ï¼šé™æ€åŒ–æš‚ä¸æ”¯æŒæœ‰å˜é‡è·¯ç”±çš„åœºæ™¯ã€‚</p>
<h2 id="HTML-åç¼€"><a href="#HTML-åç¼€" class="headerlink" title="HTML åç¼€"></a>HTML åç¼€</h2><p>æœ‰äº›é™æ€åŒ–çš„åœºæ™¯é‡Œï¼Œæ˜¯ä¸ä¼šè‡ªåŠ¨è¯»ç´¢å¼•æ–‡ä»¶çš„ï¼Œæ¯”å¦‚æ”¯ä»˜å®çš„å®¹å™¨ç¯å¢ƒï¼Œé‚£ä¹ˆå°±ä¸èƒ½ç”Ÿæˆè¿™ç§ html æ–‡ä»¶ï¼Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ list</span><br><span class="line">â”‚   â””â”€â”€ index.html</span><br><span class="line">è€Œæ˜¯ç”Ÿæˆï¼Œ</span><br><span class="line"></span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â””â”€â”€ list.html</span><br></pre></td></tr></table></figure>
<p>é…ç½®æ–¹å¼æ˜¯åœ¨ .umirc.js é‡Œï¼Œ</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  exportStatic: &#123;</span><br><span class="line">    htmlSuffix: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>umi build ä¼šç”Ÿæˆï¼Œ</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">./dist</span><br><span class="line">â”œâ”€â”€ index.html</span><br><span class="line">â”œâ”€â”€ list.html</span><br><span class="line">â””â”€â”€ static</span><br><span class="line">    â”œâ”€â”€ pages__index.5c0f5f51.async.js</span><br><span class="line">    â”œâ”€â”€ pages__list.f940b099.async.js</span><br><span class="line">    â”œâ”€â”€ umi.2924fdb7.js</span><br><span class="line">    â””â”€â”€ umi.cfe3ffab.css</span><br></pre></td></tr></table></figure>
<h2 id="é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„"><a href="#é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„" class="headerlink" title="é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„"></a>é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  exportStatic: &#123;</span><br><span class="line">    htmlSuffix: <span class="literal">true</span>,</span><br><span class="line">    dynamicRoot: <span class="literal">true</span>,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu-demo"><a href="#å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu-demo" class="headerlink" title="å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu demo"></a>å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu demo</h1><h2 id="ç›®å½•-1"><a href="#ç›®å½•-1" class="headerlink" title="ç›®å½•"></a>ç›®å½•</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+ mock</span><br><span class="line">  - index.js mockæ•°æ®</span><br><span class="line">+ src</span><br><span class="line">  + pages</span><br><span class="line">    + index</span><br><span class="line">      - index.js æ ¹è·¯ç”± å³ ç™»é™†é¡µ</span><br><span class="line">      - index.css</span><br><span class="line">      - model.js</span><br><span class="line">      - service.js</span><br><span class="line">    + dashboard</span><br><span class="line">      - index.js ç™»é™†åé¦–é¡µ</span><br><span class="line">+ utils</span><br><span class="line">  - request.js å®šä¹‰è¯·æ±‚å¯¹è±¡</span><br></pre></td></tr></table></figure>
<h2 id="é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡"><a href="#é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡" class="headerlink" title="é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡"></a>é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dva çš„fetch ç›¸å¯¹åº•å±‚ä¸€äº›ï¼Œè¦è‡ªå·±å»æ‰©å±•å¾ˆå¤šæ–¹æ³•</span></span><br><span class="line"><span class="keyword">import</span> fetch <span class="keyword">from</span> <span class="string">'dva/fetch'</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'umi/router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; message &#125; <span class="keyword">from</span> <span class="string">'antd'</span>; <span class="comment">// ä½¿ç”¨antdå¼¹çª—</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">parseJSON</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> response.json(); <span class="comment">// å¯¹äºresçš„è§£æå¿…é¡»è°ƒè¿™ä¸ªæ–¹æ³• dva é‡Œçš„ è™½ç„¶æœ‰ç‚¹å¥‡æ€ª</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkStatus</span>(<span class="params">response</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (response.status === <span class="number">200</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(response.status === <span class="number">303</span>)&#123;</span><br><span class="line">    router.replace(<span class="string">'/'</span>); <span class="comment">// cookieå¤±æ•ˆè·³å›ç™»å½•é¡µ</span></span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    response.json().then(message.error);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¹äºqueryçš„format</span></span><br><span class="line"><span class="keyword">const</span> parseQuery = <span class="function">(<span class="params">obj</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> str = <span class="string">''</span></span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="keyword">const</span> value = <span class="keyword">typeof</span> obj[key] !== <span class="string">'string'</span> ? <span class="built_in">JSON</span>.stringify(obj[key]) : obj[key]</span><br><span class="line">    str += <span class="string">'&amp;'</span> + key + <span class="string">'='</span> + value</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> str.substr(<span class="number">1</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* Requests a URL, returning a promise.</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">* @param  &#123;string&#125; url       The URL we want to request</span></span><br><span class="line"><span class="comment">* @param  &#123;object&#125; [options] The options we want to pass to "fetch"</span></span><br><span class="line"><span class="comment">* @return &#123;object&#125;           An object containing either "data" or "err"</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">const</span> request = <span class="function">(<span class="params">url, method = <span class="string">'get'</span>, data = &#123;&#125;</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">const</span> options = &#123;</span><br><span class="line">    method,   <span class="comment">// HTTPè¯·æ±‚æ–¹æ³•ï¼Œé»˜è®¤ä¸ºGET</span></span><br><span class="line">    headers:&#123;</span><br><span class="line">      <span class="string">'Content-Type'</span>: <span class="string">'application/json'</span></span><br><span class="line">    &#125;,</span><br><span class="line">    credentials: <span class="string">'include'</span> </span><br><span class="line">    <span class="comment">// æ˜¯å¦æºå¸¦cookieï¼Œé»˜è®¤ä¸ºomit,ä¸æºå¸¦; same-origi,åŒæºæºå¸¦; include,åŒæºè·¨åŸŸéƒ½æºå¸¦</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (method === <span class="string">'get'</span>) &#123;</span><br><span class="line">    url += <span class="string">'&amp;'</span> + parseQuery(data)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    options.body = <span class="built_in">JSON</span>.stringify(data);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> fetch(url, options)</span><br><span class="line">  .then(checkStatus)</span><br><span class="line">  .then(parseJSON)</span><br><span class="line">  .then(<span class="function"><span class="params">data</span> =&gt;</span> (data))</span><br><span class="line">  .catch(<span class="function"><span class="params">err</span> =&gt;</span> (&#123; err &#125;));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">get</span>: (url, data) =&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> request(url, <span class="string">'get'</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">  post: <span class="function">(<span class="params">url, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> request(url, <span class="string">'post'</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">  put: <span class="function">(<span class="params">url, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> request(url, <span class="string">'put'</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="keyword">delete</span>: <span class="function">(<span class="params">url, data</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> request(url, <span class="string">'delete'</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api-func"><a href="#åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api-func" class="headerlink" title="åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api func"></a>åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api func</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">'@/utils/request'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">login</span> (<span class="params">user = &#123;&#125;</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> request.post(<span class="string">'/login'</span>, user);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="å®šä¹‰modelå¯¹è±¡"><a href="#å®šä¹‰modelå¯¹è±¡" class="headerlink" title="å®šä¹‰modelå¯¹è±¡"></a>å®šä¹‰modelå¯¹è±¡</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> service <span class="keyword">from</span> <span class="string">'./service'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  namespace: <span class="string">'user'</span>, <span class="comment">// å®šä¹‰å‘½åç©ºé—´ è°ƒç”¨æ—¶è¦æŒ‡å®šå‘½åç©ºé—´</span></span><br><span class="line"></span><br><span class="line">  state: &#123; <span class="comment">// æ•°æ®å­˜å‚¨</span></span><br><span class="line">    user: &#123;&#125;,  <span class="comment">//reducersä¸­æ¥æ”¶æ•°æ®</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  subscriptions: &#123; <span class="comment">// æš‚æ—¶æ²¡ææ‡‚æ˜¯å¹²å•¥çš„</span></span><br><span class="line">    setup(&#123; dispatch, history &#125;) &#123;  <span class="comment">// eslint-disable-line</span></span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  effects: &#123; <span class="comment">// actions</span></span><br><span class="line">    <span class="comment">// æ˜¯ä¸ªpromise å› ä¸ºé›†æˆäº†redux-saga</span></span><br><span class="line">    * login(&#123; <span class="attr">payload</span>: &#123; user, cb = <span class="function"><span class="params">()</span> =&gt;</span> &#123;&#125; &#125;&#125;, &#123; call, put &#125;) &#123; <span class="comment">// * å£°æ˜æ˜¯ä¸ªå¼‚æ­¥func</span></span><br><span class="line">      <span class="comment">// yield å°†ç­‰å¾…å¼‚æ­¥æ–¹æ³•è¿”å›ç»“æœ ç±»ä¼¼ await</span></span><br><span class="line">      <span class="comment">// callæ˜¯dvaæ ‡å‡†ç”¨æ³•ç”¨æ¥è°ƒç”¨apiï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä½ çš„api funcï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯ä½ ä¼ å…¥api func çš„å‚æ•°</span></span><br><span class="line">      <span class="keyword">const</span> result = <span class="keyword">yield</span> call(service.login, user);<span class="comment">// å¦‚æœä½¿ç”¨  &#123;å‚æ•°&#125;  ï¼Œåˆ™æ˜¯ä¸€ä¸ªå¯¹è±¡</span></span><br><span class="line">      <span class="comment">//æŠŠè¯·æ±‚çš„æ•°æ®ä¿å­˜èµ·æ¥</span></span><br><span class="line">      <span class="comment">//æ•°æ®æ›´æ–°ä¼šå¸¦åŠ¨é¡µé¢é‡æ–°æ¸²æŸ“</span></span><br><span class="line">      <span class="keyword">yield</span> put(&#123;</span><br><span class="line">        type: <span class="string">'setUser'</span>,  <span class="comment">//reducersä¸­çš„æ–¹æ³•å</span></span><br><span class="line">        payload: &#123;</span><br><span class="line">          user: result,  <span class="comment">//ç½‘ç»œè¿”å›çš„è¦ä¿ç•™çš„æ•°æ®</span></span><br><span class="line">        &#125;,</span><br><span class="line">      &#125;);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  reducers: &#123;</span><br><span class="line">    <span class="comment">// æ³¨æ„ï¼ï¼ï¼effectsä¸­çš„æ–¹æ³•åä¸èƒ½ä¸reducersä¸­çš„æ–¹æ³•åé‡å¤ï¼Œå¦åˆ™ä¼šæ­»å¾ªç¯</span></span><br><span class="line">    setUser(state, &#123; <span class="attr">payload</span>: &#123; user &#125; &#125;) &#123;</span><br><span class="line">      <span class="keyword">return</span> &#123;</span><br><span class="line">        ...state, </span><br><span class="line">        user,</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;,</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="mock-index-jsåŠ äº›mockæ•°æ®"><a href="#mock-index-jsåŠ äº›mockæ•°æ®" class="headerlink" title="mock/index.jsåŠ äº›mockæ•°æ®"></a>mock/index.jsåŠ äº›mockæ•°æ®</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="comment">// æ”¯æŒå€¼ä¸º Object å’Œ Array</span></span><br><span class="line">  <span class="string">'POST /login'</span>: <span class="function">(<span class="params">req, res</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; account, password &#125; = req.body;</span><br><span class="line">    <span class="keyword">if</span> (account === <span class="string">'umi'</span> &amp;&amp; password === <span class="string">'1234'</span>) &#123;</span><br><span class="line">      res.status(<span class="number">200</span>).send(&#123;</span><br><span class="line">        account: <span class="string">'umi'</span>,</span><br><span class="line">        name: <span class="string">'ä¹Œç±³'</span>,</span><br><span class="line">        role: <span class="string">'è¶…çº§ç®¡ç†å‘˜'</span>,</span><br><span class="line">        permissions: [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>],</span><br><span class="line">      &#125;);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      res.status(<span class="number">403</span>).json(<span class="string">'è´¦å·æˆ–å¯†ç é”™è¯¯'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="loginé¡µé¢ï¼ˆantdï¼‰-ï¼Œ-æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬"><a href="#loginé¡µé¢ï¼ˆantdï¼‰-ï¼Œ-æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬" class="headerlink" title="loginé¡µé¢ï¼ˆantdï¼‰ ï¼Œ æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬"></a>loginé¡µé¢ï¼ˆantdï¼‰ ï¼Œ æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">'react'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; connect &#125; <span class="keyword">from</span> <span class="string">'dva'</span>;</span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">'umi/router'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; Form, Input, Icon, Checkbox, Button &#125; <span class="keyword">from</span> <span class="string">'antd'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> style <span class="keyword">from</span> <span class="string">'./index.css'</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> Login = <span class="class"><span class="keyword">class</span> <span class="keyword">extends</span> <span class="title">React</span>.<span class="title">Component</span> </span>&#123;</span><br><span class="line">  handleSubmit = <span class="function"><span class="params">e</span> =&gt;</span> &#123;</span><br><span class="line">    e.preventDefault();</span><br><span class="line">    <span class="keyword">this</span>.props.form.validateFields(<span class="function">(<span class="params">err, values</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (!err) &#123;</span><br><span class="line">        <span class="comment">// actions è°ƒç”¨æ–¹å¼ å‘½åç©ºé—´/actionåå­—</span></span><br><span class="line">        <span class="comment">// æ˜¯ä¸ªpromise å› ä¸ºé›†æˆäº†redux-saga</span></span><br><span class="line">        <span class="keyword">this</span>.props.dispatch(&#123;</span><br><span class="line">          type: <span class="string">'user/login'</span>,</span><br><span class="line">          payload: &#123;</span><br><span class="line">            user: &#123;</span><br><span class="line">              account: values.account,</span><br><span class="line">              password: values.password,</span><br><span class="line">            &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;)</span><br><span class="line">        .then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (values.remember) &#123;</span><br><span class="line">            <span class="built_in">window</span>.localStorage.setItem(<span class="string">'account'</span>, values.account);</span><br><span class="line">            <span class="built_in">window</span>.localStorage.setItem(<span class="string">'password'</span>, values.password);</span><br><span class="line">          &#125;</span><br><span class="line">          router.push(<span class="string">'/dashboard'</span>);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  render() &#123;</span><br><span class="line">    <span class="keyword">const</span> &#123; getFieldDecorator &#125; = <span class="keyword">this</span>.props.form;</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">      &lt;div className=&#123;style.loginPanel&#125;&gt;</span><br><span class="line">        &lt;div className=&#123;style.loginForm&#125;&gt;</span><br><span class="line">          &lt;Form onSubmit=&#123;<span class="keyword">this</span>.handleSubmit&#125;&gt;</span><br><span class="line">            &lt;Form.Item&gt;</span><br><span class="line">              &#123;getFieldDecorator(<span class="string">'account'</span>, &#123;</span><br><span class="line">                rules: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">'Please input your username!'</span> &#125;],</span><br><span class="line">              &#125;)(</span><br><span class="line">                &lt;Input</span><br><span class="line">                  prefix=&#123;&lt;Icon type=<span class="string">"user"</span> style=&#123;&#123; <span class="attr">color</span>: <span class="string">'rgba(0,0,0,.25)'</span> &#125;&#125; /&gt;&#125;</span><br><span class="line">                  placeholder=<span class="string">"Username"</span></span><br><span class="line">                /&gt;,</span><br><span class="line">              )&#125;</span><br><span class="line">            &lt;<span class="regexp">/Form.Item&gt;</span></span><br><span class="line"><span class="regexp">            &lt;Form.Item&gt;</span></span><br><span class="line"><span class="regexp">              &#123;getFieldDecorator('password', &#123;</span></span><br><span class="line"><span class="regexp">                rules: [&#123; required: true, message: 'Please input your Password!' &#125;],</span></span><br><span class="line"><span class="regexp">              &#125;)(</span></span><br><span class="line"><span class="regexp">                &lt;Input</span></span><br><span class="line"><span class="regexp">                  prefix=&#123;&lt;Icon type="lock" style=&#123;&#123; color: 'rgba(0,0,0,.25)' &#125;&#125; /</span>&gt;&#125;</span><br><span class="line">                  type=<span class="string">"password"</span></span><br><span class="line">                  placeholder=<span class="string">"Password"</span></span><br><span class="line">                /&gt;,</span><br><span class="line">              )&#125;</span><br><span class="line">            &lt;<span class="regexp">/Form.Item&gt;</span></span><br><span class="line"><span class="regexp">            &lt;Form.Item&gt;</span></span><br><span class="line"><span class="regexp">              &#123;getFieldDecorator('remember', &#123;</span></span><br><span class="line"><span class="regexp">                valuePropName: 'checked',</span></span><br><span class="line"><span class="regexp">                initialValue: true,</span></span><br><span class="line"><span class="regexp">              &#125;)(&lt;Checkbox className=&#123;style.remember&#125;&gt;Remember me&lt;/</span>Checkbox&gt;)&#125;</span><br><span class="line">              &lt;Button type=<span class="string">"primary"</span> htmlType=<span class="string">"submit"</span> className=<span class="string">"login-form-button"</span>&gt;</span><br><span class="line">                Log <span class="keyword">in</span></span><br><span class="line">              &lt;<span class="regexp">/Button&gt;</span></span><br><span class="line"><span class="regexp">            &lt;/</span>Form.Item&gt;</span><br><span class="line">          &lt;<span class="regexp">/Form&gt;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>div&gt;</span><br><span class="line">      &lt;<span class="regexp">/div&gt;</span></span><br><span class="line"><span class="regexp">    );</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br><span class="line"><span class="regexp">&#125;</span></span><br><span class="line"><span class="regexp">Login = Form.create(&#123; name: 'normal_login' &#125;)(Login); /</span><span class="regexp">/ antd form ä½¿ç”¨æ–¹æ³•</span></span><br><span class="line"><span class="regexp">export default  connect()(Login);</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ å°†actions connectè¿›æ¥ ä¸éœ€è¦å†åƒreactä¸­ä¸€æ ·æ‰‹åŠ¨åŠ actions</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/ è¿™é‡Œåªéœ€è¦æ‰‹åŠ¨connect mapStatusToProps</span></span><br></pre></td></tr></table></figure>

      
      
        <div class="page-reward">
          <p><a href="javascript:void(0)" onclick="dashangToggle()" class="dashang">èµ</a></p>
          <div class="hide_box"></div>
          <div class="shang_box">
            <a class="shang_close" href="javascript:void(0)" onclick="dashangToggle()">Ã—</a>
            <div class="shang_tit">
              <p>çº¯å±å¥½ç©</p>
            </div>
            <div class="shang_payimg">
              <img src="/img/alipayimg.jpg" alt="æ‰«ç æ”¯æŒ" title="æ‰«ä¸€æ‰«">
            </div>
              <div class="pay_explain">æ‰«ç æ‰“èµï¼Œä½ è¯´å¤šå°‘å°±å¤šå°‘</div>
            <div class="shang_payselect">
              
                <div class="pay_item checked" data-id="alipay">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/alipay.png" alt="æ”¯ä»˜å®"></span>
                </div>
              
              
                <div class="pay_item" data-id="wechat">
                  <span class="radiobox"></span>
                  <span class="pay_logo"><img src="/img/weixin.png" alt="å¾®ä¿¡"></span>
                </div>
              
            </div>
            <div class="shang_info">
              <p>æ‰“å¼€<span id="shang_pay_txt">æ”¯ä»˜å®</span>æ‰«ä¸€æ‰«ï¼Œå³å¯è¿›è¡Œæ‰«ç æ‰“èµå“¦</p>
            </div>
          </div>
        </div>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/zepto/1.2.0/zepto.min.js"></script>
        <script type="text/javascript">
          $(".pay_item").click(function(){
            $(this).addClass('checked').siblings('.pay_item').removeClass('checked');
            var dataid=$(this).attr('data-id');
            $(".shang_payimg img").attr("src","/img/"+dataid+"img.jpg");
            $("#shang_pay_txt").text(dataid=="alipay"?"æ”¯ä»˜å®":"å¾®ä¿¡");
          });
          function dashangToggle(){
            
            $(".hide_box").fadeToggle();
            $(".shang_box").fadeToggle();
          }
        </script>
      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>æœ¬æ–‡æ ‡é¢˜:</span><a href="/2019/05/09/umiå®æˆ˜ç¬”è®°/">umiå®æˆ˜ç¬”è®°</a></p>
        <p><span>æ–‡ç« ä½œè€…:</span><a href="/" title="è®¿é—® GapGao çš„ä¸ªäººåšå®¢">GapGao</a></p>
        <p><span>å‘å¸ƒæ—¶é—´:</span>2019å¹´05æœˆ09æ—¥ - 21æ—¶42åˆ†</p>
        <p><span>æœ€åæ›´æ–°:</span>2024å¹´01æœˆ04æ—¥ - 16æ—¶04åˆ†</p>
        <p>
            <span>åŸå§‹é“¾æ¥:</span><a class="post-url" href="/2019/05/09/umiå®æˆ˜ç¬”è®°/" title="umiå®æˆ˜ç¬”è®°">https://gapgao.github.io/2019/05/09/umiå®æˆ˜ç¬”è®°/</a>
            <span class="copy-path" data-clipboard-text="åŸæ–‡: https://gapgao.github.io/2019/05/09/umiå®æˆ˜ç¬”è®°/ã€€ã€€ä½œè€…: GapGao" title="ç‚¹å‡»å¤åˆ¶æ–‡ç« é“¾æ¥"><i class="fa fa-clipboard"></i></span>
            <script src="/js/clipboard.min.js"></script>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>è®¸å¯åè®®:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="ä¸­å›½å¤§é™† (CC BY-NC-SA 3.0 CN)" target="_blank">"ç½²å-éå•†ç”¨-ç›¸åŒæ–¹å¼å…±äº« 3.0"</a> è½¬è½½è¯·ä¿ç•™åŸæ–‡é“¾æ¥åŠä½œè€…ã€‚
        </p>
    </div>



<nav id="article-nav">
  
    <a href="/2019/06/01/vConsoleè°ƒè¯•console/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          vConsoleè°ƒè¯•console
        
      </div>
    </a>
  
  
    <a href="/2019/04/27/å­¦ä¹ è®¡åˆ’/" id="article-nav-older" class="article-nav-link-wrap">
      <div class="article-nav-title">å­¦ä¹ è®¡åˆ’</div>
      <strong class="article-nav-caption">></strong>
    </a>
  
</nav>

  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">æ–‡ç« ç›®å½•</strong>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ä»‹ç»"><span class="toc-number">1.</span> <span class="toc-text">ä»‹ç»</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç‰¹æ€§"><span class="toc-number">2.</span> <span class="toc-text">ç‰¹æ€§</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å®‰è£…"><span class="toc-number">3.</span> <span class="toc-text">å®‰è£…</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#é¡¹ç›®æ­å»º"><span class="toc-number">4.</span> <span class="toc-text">é¡¹ç›®æ­å»º</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æ–‡ä»¶ç›®å½•ä»‹ç»"><span class="toc-number">5.</span> <span class="toc-text">æ–‡ä»¶ç›®å½•ä»‹ç»</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç›®å½•"><span class="toc-number">5.1.</span> <span class="toc-text">ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ES6-è¯­æ³•"><span class="toc-number">5.2.</span> <span class="toc-text">ES6 è¯­æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dist"><span class="toc-number">5.3.</span> <span class="toc-text">dist</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mock"><span class="toc-number">5.4.</span> <span class="toc-text">mock</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src"><span class="toc-number">5.5.</span> <span class="toc-text">src</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-layouts-index-js"><span class="toc-number">5.6.</span> <span class="toc-text">src/layouts/index.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-pages"><span class="toc-number">5.7.</span> <span class="toc-text">src/pages</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-pages-404-js"><span class="toc-number">5.8.</span> <span class="toc-text">src/pages/404.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-pages-document-ejs"><span class="toc-number">5.9.</span> <span class="toc-text">src/pages/document.ejs</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-pages-umi"><span class="toc-number">5.10.</span> <span class="toc-text">src/pages/.umi</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-pages-umi-production"><span class="toc-number">5.11.</span> <span class="toc-text">src/pages/.umi-production</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#test-js-ts-å’Œ-e2e-js-ts"><span class="toc-number">5.12.</span> <span class="toc-text">.test.(js|ts) å’Œ .e2e.(js|ts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-global-js-ts"><span class="toc-number">5.13.</span> <span class="toc-text">src/global.(js|ts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-global-css-less-sass-scss"><span class="toc-number">5.14.</span> <span class="toc-text">src/global.(css|less|sass|scss)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#src-app-js-ts"><span class="toc-number">5.15.</span> <span class="toc-text">src/app.(js|ts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#umirc-js-ts-å’Œ-config-config-js-ts"><span class="toc-number">5.16.</span> <span class="toc-text">.umirc.(js|ts) å’Œ config/config.(js|ts)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#env"><span class="toc-number">5.17.</span> <span class="toc-text">.env</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰"><span class="toc-number">6.</span> <span class="toc-text">è·¯ç”±ï¼ˆé‡ç‚¹ï¼Œumiå·²çº¦å®šå¼è·¯ç”±ä¸ºåŸºç¡€æ‹“å±•ï¼‰</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#çº¦å®šå¼è·¯ç”±"><span class="toc-number">6.1.</span> <span class="toc-text">çº¦å®šå¼è·¯ç”±</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#åŸºç¡€è·¯ç”±"><span class="toc-number">6.1.1.</span> <span class="toc-text">åŸºç¡€è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åŠ¨æ€è·¯ç”±"><span class="toc-number">6.1.2.</span> <span class="toc-text">åŠ¨æ€è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¯é€‰çš„åŠ¨æ€è·¯ç”±"><span class="toc-number">6.1.3.</span> <span class="toc-text">å¯é€‰çš„åŠ¨æ€è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#åµŒå¥—è·¯ç”±"><span class="toc-number">6.1.4.</span> <span class="toc-text">åµŒå¥—è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¨å±€-layout"><span class="toc-number">6.1.5.</span> <span class="toc-text">å…¨å±€ layout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ä¸åŒçš„å…¨å±€-layout"><span class="toc-number">6.1.6.</span> <span class="toc-text">ä¸åŒçš„å…¨å±€ layout</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#404-è·¯ç”±"><span class="toc-number">6.1.7.</span> <span class="toc-text">404 è·¯ç”±</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±"><span class="toc-number">6.1.8.</span> <span class="toc-text">é€šè¿‡æ³¨é‡Šæ‰©å±•è·¯ç”±</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®å¼è·¯ç”±"><span class="toc-number">6.2.</span> <span class="toc-text">é…ç½®å¼è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æƒé™è·¯ç”±"><span class="toc-number">6.3.</span> <span class="toc-text">æƒé™è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è·¯ç”±åŠ¨æ•ˆ"><span class="toc-number">6.4.</span> <span class="toc-text">è·¯ç”±åŠ¨æ•ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é¢åŒ…å±‘"><span class="toc-number">6.5.</span> <span class="toc-text">é¢åŒ…å±‘</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¯ç”¨-Hash-è·¯ç”±"><span class="toc-number">6.6.</span> <span class="toc-text">å¯ç”¨ Hash è·¯ç”±</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Scroll-to-top"><span class="toc-number">6.7.</span> <span class="toc-text">Scroll to top</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åœ¨é¡µé¢é—´è·³è½¬"><span class="toc-number">7.</span> <span class="toc-text">åœ¨é¡µé¢é—´è·³è½¬</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#å£°æ˜å¼"><span class="toc-number">7.1.</span> <span class="toc-text">å£°æ˜å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å‘½ä»¤å¼"><span class="toc-number">7.2.</span> <span class="toc-text">å‘½ä»¤å¼</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#é…ç½®"><span class="toc-number">8.</span> <span class="toc-text">é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®æ–‡ä»¶"><span class="toc-number">8.1.</span> <span class="toc-text">é…ç½®æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#umirc-local-js"><span class="toc-number">8.2.</span> <span class="toc-text">.umirc.local.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UMI-ENV"><span class="toc-number">8.3.</span> <span class="toc-text">UMI_ENV</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#HTML-æ¨¡æ¿"><span class="toc-number">9.</span> <span class="toc-text">HTML æ¨¡æ¿</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¿®æ”¹é»˜è®¤æ¨¡æ¿"><span class="toc-number">9.1.</span> <span class="toc-text">ä¿®æ”¹é»˜è®¤æ¨¡æ¿</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®æ¨¡æ¿"><span class="toc-number">9.2.</span> <span class="toc-text">é…ç½®æ¨¡æ¿</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿"><span class="toc-number">10.</span> <span class="toc-text">é’ˆå¯¹ç‰¹å®šé¡µé¢æŒ‡å®šæ¨¡æ¿</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Mock-æ•°æ®"><span class="toc-number">11.</span> <span class="toc-text">Mock æ•°æ®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨-umi-çš„-mock-åŠŸèƒ½"><span class="toc-number">11.1.</span> <span class="toc-text">ä½¿ç”¨ umi çš„ mock åŠŸèƒ½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¼•å…¥-Mock-js"><span class="toc-number">11.2.</span> <span class="toc-text">å¼•å…¥ Mock.js</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´"><span class="toc-number">11.3.</span> <span class="toc-text">æ·»åŠ è·¨åŸŸè¯·æ±‚å¤´</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åˆç†çš„æ‹†åˆ†ä½ çš„-mock-æ–‡ä»¶"><span class="toc-number">11.4.</span> <span class="toc-text">åˆç†çš„æ‹†åˆ†ä½ çš„ mock æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ"><span class="toc-number">11.5.</span> <span class="toc-text">å¦‚ä½•æ¨¡æ‹Ÿå»¶è¿Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æ‰‹åŠ¨æ·»åŠ -setTimeout-æ¨¡æ‹Ÿå»¶è¿Ÿ"><span class="toc-number">11.6.</span> <span class="toc-text">æ‰‹åŠ¨æ·»åŠ  setTimeout æ¨¡æ‹Ÿå»¶è¿Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ"><span class="toc-number">11.7.</span> <span class="toc-text">ä½¿ç”¨æ’ä»¶æ¨¡æ‹Ÿå»¶è¿Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åŠ¨æ€-Mock-æ•°æ®"><span class="toc-number">11.8.</span> <span class="toc-text">åŠ¨æ€ Mock æ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#è”è°ƒ"><span class="toc-number">11.9.</span> <span class="toc-text">è”è°ƒ</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Use-umi-with-dva-é‡ç‚¹"><span class="toc-number">12.</span> <span class="toc-text">Use umi with dva(é‡ç‚¹)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç‰¹æ€§-1"><span class="toc-number">12.1.</span> <span class="toc-text">ç‰¹æ€§</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨"><span class="toc-number">12.2.</span> <span class="toc-text">ä½¿ç”¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#model-æ³¨å†Œ"><span class="toc-number">12.3.</span> <span class="toc-text">model æ³¨å†Œ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®åŠæ’ä»¶"><span class="toc-number">12.4.</span> <span class="toc-text">é…ç½®åŠæ’ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#FAQ"><span class="toc-number">12.5.</span> <span class="toc-text">FAQ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#url-å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ"><span class="toc-number">12.5.1.</span> <span class="toc-text">url å˜åŒ–äº†ï¼Œä½†é¡µé¢ç»„ä»¶ä¸åˆ·æ–°ï¼Œæ˜¯ä»€ä¹ˆåŸå› ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•è®¿é—®åˆ°-store-æˆ–-dispatch-æ–¹æ³•ï¼Ÿ"><span class="toc-number">12.5.2.</span> <span class="toc-text">å¦‚ä½•è®¿é—®åˆ° store æˆ– dispatch æ–¹æ³•ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å¦‚ä½•ç¦ç”¨åŒ…æ‹¬-component-å’Œ-models-çš„æŒ‰éœ€åŠ è½½ï¼Ÿ"><span class="toc-number">12.5.3.</span> <span class="toc-text">å¦‚ä½•ç¦ç”¨åŒ…æ‹¬ component å’Œ models çš„æŒ‰éœ€åŠ è½½ï¼Ÿ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#å…¨å±€-layout-ä½¿ç”¨-connect-åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ"><span class="toc-number">12.5.4.</span> <span class="toc-text">å…¨å±€ layout ä½¿ç”¨ connect åè·¯ç”±åˆ‡æ¢åæ²¡æœ‰åˆ·æ–°ï¼Ÿ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#æŒ‰éœ€åŠ è½½"><span class="toc-number">13.</span> <span class="toc-text">æŒ‰éœ€åŠ è½½</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#æŒ‰éœ€åŠ è½½ç»„ä»¶"><span class="toc-number">13.1.</span> <span class="toc-text">æŒ‰éœ€åŠ è½½ç»„ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æŒ‰éœ€åŠ è½½æ¨¡å—"><span class="toc-number">13.2.</span> <span class="toc-text">æŒ‰éœ€åŠ è½½æ¨¡å—</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#è¿è¡Œæ—¶é…ç½®"><span class="toc-number">14.</span> <span class="toc-text">è¿è¡Œæ—¶é…ç½®</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ"><span class="toc-number">14.1.</span> <span class="toc-text">ä¸ºä»€ä¹ˆæœ‰è¿è¡Œæ—¶é…ç½®ï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®æ–¹å¼"><span class="toc-number">14.2.</span> <span class="toc-text">é…ç½®æ–¹å¼</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é…ç½®åˆ—è¡¨"><span class="toc-number">14.3.</span> <span class="toc-text">é…ç½®åˆ—è¡¨</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#patchRoutes"><span class="toc-number">14.3.1.</span> <span class="toc-text">patchRoutes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#render"><span class="toc-number">14.3.2.</span> <span class="toc-text">render</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#onRouteChange"><span class="toc-number">14.3.3.</span> <span class="toc-text">onRouteChange</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rootContainer"><span class="toc-number">14.3.4.</span> <span class="toc-text">rootContainer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#modifyRouteProps"><span class="toc-number">14.3.5.</span> <span class="toc-text">modifyRouteProps</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰"><span class="toc-number">15.</span> <span class="toc-text">åŒºå—ï¼ˆåŒºå—å¼€å‘å°±ä¸èµ˜è¿°äº†ï¼Œæ¯”è¾ƒé«˜çº§çš„ä½¿ç”¨æ–¹æ³•ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#éƒ¨ç½²"><span class="toc-number">16.</span> <span class="toc-text">éƒ¨ç½²</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#é»˜è®¤æ–¹æ¡ˆ"><span class="toc-number">16.1.</span> <span class="toc-text">é»˜è®¤æ–¹æ¡ˆ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸è¾“å‡º-html-æ–‡ä»¶"><span class="toc-number">16.2.</span> <span class="toc-text">ä¸è¾“å‡º html æ–‡ä»¶</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#éƒ¨ç½²-html-åˆ°éæ ¹ç›®å½•"><span class="toc-number">16.3.</span> <span class="toc-text">éƒ¨ç½² html åˆ°éæ ¹ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨-hashHistory"><span class="toc-number">16.4.</span> <span class="toc-text">ä½¿ç”¨ hashHistory</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#æŒ‰éœ€åŠ è½½-1"><span class="toc-number">16.5.</span> <span class="toc-text">æŒ‰éœ€åŠ è½½</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ–-cdn"><span class="toc-number">16.6.</span> <span class="toc-text">é™æ€èµ„æºåœ¨éæ ¹ç›®å½•æˆ– cdn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½¿ç”¨-runtime-çš„-publicPath"><span class="toc-number">16.7.</span> <span class="toc-text">ä½¿ç”¨ runtime çš„ publicPath</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é™æ€åŒ–"><span class="toc-number">16.8.</span> <span class="toc-text">é™æ€åŒ–</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML-åç¼€"><span class="toc-number">16.9.</span> <span class="toc-text">HTML åç¼€</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„"><span class="toc-number">16.10.</span> <span class="toc-text">é™æ€åŒ–åè¾“å‡ºåˆ°ä»»æ„è·¯å¾„</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu-demo"><span class="toc-number">17.</span> <span class="toc-text">å®æˆ˜-å†™ä¸€ä¸ªç™»é™†åŠç®¡ç†åå°menu demo</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ç›®å½•-1"><span class="toc-number">17.1.</span> <span class="toc-text">ç›®å½•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡"><span class="toc-number">17.2.</span> <span class="toc-text">é¦–å…ˆå®šä¹‰utilsä¸‹çš„requestè¯·æ±‚å¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api-func"><span class="toc-number">17.3.</span> <span class="toc-text">åœ¨serviceä¸‹exportå‡ºåœ¨modelä¸­è°ƒç”¨çš„api func</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#å®šä¹‰modelå¯¹è±¡"><span class="toc-number">17.4.</span> <span class="toc-text">å®šä¹‰modelå¯¹è±¡</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#mock-index-jsåŠ äº›mockæ•°æ®"><span class="toc-number">17.5.</span> <span class="toc-text">mock/index.jsåŠ äº›mockæ•°æ®</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#loginé¡µé¢ï¼ˆantdï¼‰-ï¼Œ-æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬"><span class="toc-number">17.6.</span> <span class="toc-text">loginé¡µé¢ï¼ˆantdï¼‰ ï¼Œ æ¥å£è°ƒç”¨åŠè·¯ç”±è·³è½¬</span></a></li></ol></li></ol>
</div>
<input type="button" id="tocButton" value="éšè—ç›®å½•" title="ç‚¹å‡»æŒ‰é’®éšè—æˆ–è€…æ˜¾ç¤ºæ–‡ç« ç›®å½•">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script>
    var valueHide = "éšè—ç›®å½•";
    var valueShow = "æ˜¾ç¤ºç›®å½•";

    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
    }
</script>





<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="åˆ†äº«åˆ°å¾®ä¿¡"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="åˆ†äº«åˆ°QQå¥½å‹"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="åˆ†äº«åˆ°Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="åˆ†äº«åˆ°Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="åˆ†äº«åˆ°linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="åˆ†äº«åˆ°å¤åˆ¶ç½‘å€"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <div id="gitments"></div>
<script src="/js/gitment.browser.js"></script>
<script>
    var gitment = new Gitment({
      id: window.location.pathname,
      owner: 'GapGao',
      repo: 'gapgao.github.io',
      oauth: {
        client_id: 'b37cf634d1c116549841',
        client_secret: '54bad933f4f25c63418d4c79fe77cbbba1c465b5',
      },
    })
    gitment.render('gitments')
</script>
    



    <div class="scroll" id="post-nav-button">
        
            <a href="/2019/06/01/vConsoleè°ƒè¯•console/" title="ä¸Šä¸€ç¯‡: vConsoleè°ƒè¯•console">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="æ–‡ç« åˆ—è¡¨"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a href="/2019/04/27/å­¦ä¹ è®¡åˆ’/" title="ä¸‹ä¸€ç¯‡: å­¦ä¹ è®¡åˆ’">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2023/12/28/rn/">RNå¼€å‘ä¸ä½¿ç”¨Expo+EASæ‰“åŒ…å‘å¸ƒåŠé…å¥—è‹¹æœå¼€å‘</a></li><li class="post-list-item"><a class="post-list-link" href="/2021/02/28/viteæ˜¯ä»€ä¹ˆ/">viteæ˜¯ä»€ä¹ˆ</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/10/19/vue3ä¹‹åˆä½“éªŒ/">vue3ä¹‹åˆä½“éªŒ</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/09/21/å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆä¸‰ï¼‰- E2Eæµ‹è¯•/">å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆä¸‰ï¼‰- E2Eæµ‹è¯•</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/08/22/å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆäºŒï¼‰- å•å…ƒæµ‹è¯•/">å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆäºŒï¼‰- å•å…ƒæµ‹è¯•</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/07/25/å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆä¸€ï¼‰/">å‰ç«¯è‡ªåŠ¨åŒ–æµ‹è¯•ï¼ˆä¸€ï¼‰</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/06/28/åˆæ¢Deno/">åˆæ¢Deno</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/17/webpack-rollup-parcel/">webpack-rollup-parcel</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/17/ASTæŠ½è±¡è¯­æ³•æ ‘/">ASTæŠ½è±¡è¯­æ³•æ ‘</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/04/25/ES6-Proxyèƒ½å¹²ç‚¹å•¥/">ES6-Proxy èƒ½å¹²ç‚¹å•¥</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/03/29/æˆ‘çˆ±è¯»æºç ç³»åˆ—ä¹‹é£å†°é…ç½®å¼è·¯ç”±/">æˆ‘çˆ±è¯»æºç ç³»åˆ—ä¹‹é£å†°é…ç½®å¼è·¯ç”±</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/02/23/ææ‡‚CJS&UMD&ESM/">ææ‡‚CJS & UMD & ESM</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/01/31/react15å‡16/">react15å‡16</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/12/17/å°ç¨‹åºå¼€å‘ç¬”è®°/">å°ç¨‹åºå¼€å‘ç¬”è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/11/21/æ·±å…¥ç†è§£JavaScriptçš„è®¾è®¡æ¨¡å¼/">æ·±å…¥ç†è§£JavaScriptçš„è®¾è®¡æ¨¡å¼</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/10/24/ç”¨preloadé¢„åŠ è½½é¡µé¢èµ„æº/">ç”¨preloadé¢„åŠ è½½é¡µé¢èµ„æº</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/09/25/åˆæ¢WebAssembly/">åˆæ¢WebAssembly</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/08/25/å®Œå…¨ç†è§£react Fiber/">å®Œå…¨ç†è§£react Fiber</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/07/20/Nuxt-expressè¸©å‘æ—¥è®°/">Nuxt+expressè¸©å‘æ—¥è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/01/æœ¬åœ°å¾®ä¿¡çœŸæœºè°ƒè¯•æ–¹æ³•/">æœ¬åœ°å¾®ä¿¡çœŸæœºè°ƒè¯•æ–¹æ³•</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/01/chromeæ¨¡æ‹Ÿå¾®ä¿¡æµè§ˆå™¨device/">chromeæ¨¡æ‹Ÿå¾®ä¿¡æµè§ˆå™¨device</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/06/01/vConsoleè°ƒè¯•console/">vConsoleè°ƒè¯•console</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/05/09/umiå®æˆ˜ç¬”è®°/">umiå®æˆ˜ç¬”è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2019/04/27/å­¦ä¹ è®¡åˆ’/">å­¦ä¹ è®¡åˆ’</a></li></ul>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
    <script>
        $(".post-list").addClass("toc-article");
        $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
            }
        })
    </script>



    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2024 GapGao
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/luuman/hexo-theme-spfk" target="_blank">spfk</a> by luuman
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style="display:none">
                        <span id="site-visit">åˆ°è®¿æ•°: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style="display:none">
                        <span id="page-visit">æœ¬é¡µé˜…è¯»é‡: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    <script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>
<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 24;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>





<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(

            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


    <script type="text/javascript">
      window.onload = function(){
        document.getElementById("search").onclick = function(){
            console.log("search")
            search();
        }
      }
      function search(){
        (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
        (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
        e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
        })(window,document,'script','//s.swiftypecdn.com/install/v2/st.js','_st');

        _st('install','A1Pz-LKMXbrzcFg2FWi6','2.0.0');
      }
    </script>

  </div>
</body>
</html>